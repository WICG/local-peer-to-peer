<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Local Peer-to-Peer API</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version e20e08949, updated Wed Jan 24 11:50:28 2024 -0800" name="generator">
  <link href="https://WICG.github.io/local-peer-to-peer/" rel="canonical">
  <meta content="57be8da16f00fbbb9c5c792582dac8f6819481b6" name="revision">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Local Peer-to-Peer API</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2024-01-25">25 January 2024</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://WICG.github.io/local-peer-to-peer/">https://WICG.github.io/local-peer-to-peer/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/local-peer-to-peer/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:anssi.kostiainen@intel.com">Anssi Kostiainen</a> (<a class="p-org org" href="https://intel.com">Intel</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:belem.zhang@intel.com">Belem Zhang</a> (<a class="p-org org" href="https://intel.com">Intel</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mail@backkem.me">Michiel De Backker</a> (<a class="p-org org" href="https://twintag.com">Twintag</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:wei4.wang@intel.com">Wei Wang</a> (<a class="p-org org" href="https://intel.com">Intel</a>)
     <dt>Tests:
     <dd><a href="https://github.com/w3c/web-platform-tests/tree/master/local-peer-to-peer">web-platform-tests local-peer-to-peer/</a> (<a href="https://github.com/w3c/web-platform-tests/labels/local-peer-to-peer">ongoing work</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 2024 the Contributors to the Local Peer-to-Peer API Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Local Peer-to-Peer is a Web platform API proposal for local communication between browsers without the aid of a server.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#permission-policy-integration"><span class="secno">2</span> <span class="content">Permission Policy Integration</span></a>
    <li>
     <a href="#peer-management"><span class="secno">3</span> <span class="content">Peer Management</span></a>
     <ol class="toc">
      <li><a href="#known-peers"><span class="secno">3.1</span> <span class="content">Known peers</span></a>
      <li><a href="#peer-advertisement"><span class="secno">3.2</span> <span class="content">Peer advertisement</span></a>
      <li><a href="#peer-discovery"><span class="secno">3.3</span> <span class="content">Peer discovery</span></a>
      <li><a href="#peer-authentication"><span class="secno">3.4</span> <span class="content">Peer authentication</span></a>
      <li><a href="#peer-grant"><span class="secno">3.5</span> <span class="content">Peer grant</span></a>
     </ol>
    <li>
     <a href="#protocol-concepts"><span class="secno">4</span> <span class="content">Protocol concepts</span></a>
     <ol class="toc">
      <li><a href="#data-channel-extension"><span class="secno">4.1</span> <span class="content">Data channel extension</span></a>
      <li><a href="#webtransport-extension"><span class="secno">4.2</span> <span class="content">WebTransport extension</span></a>
     </ol>
    <li>
     <a href="#local-https"><span class="secno">5</span> <span class="content">Local HTTPS</span></a>
     <ol class="toc">
      <li><a href="#local-https-discovery"><span class="secno">5.1</span> <span class="content">Endpoint discovery</span></a>
     </ol>
    <li>
     <a href="#lp2p-receiver"><span class="secno">6</span> <span class="content">LP2PReceiver Interface</span></a>
     <ol class="toc">
      <li><a href="#lp2p-receiver-options"><span class="secno">6.1</span> <span class="content">LP2PReceiverOptions</span></a>
      <li><a href="#lp2p-receiver-connection-event"><span class="secno">6.2</span> <span class="content">LP2PConnectionEvent</span></a>
      <li><a href="#lp2p-receiver-events"><span class="secno">6.3</span> <span class="content">Events</span></a>
      <li><a href="#lp2p-receiver-event-handlers"><span class="secno">6.4</span> <span class="content">Event handlers</span></a>
      <li><a href="#lp2p-receiver-examples"><span class="secno">6.5</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#lp2p-request"><span class="secno">7</span> <span class="content">The LP2PRequest Interface</span></a>
     <ol class="toc">
      <li><a href="#lp2p-request-options"><span class="secno">7.1</span> <span class="content">LP2PRequestOptions</span></a>
      <li><a href="#lp2p-request-examples"><span class="secno">7.2</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#lp2p-connection"><span class="secno">8</span> <span class="content">The LP2PConnection Interface</span></a>
     <ol class="toc">
      <li><a href="#lp2p-connection-quic-transport-extensions"><span class="secno">8.1</span> <span class="content">LP2PQuicTransport Interface Extensions</span></a>
      <li><a href="#lp2p-connection-examples"><span class="secno">8.2</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#lp2p-data-channel"><span class="secno">9</span> <span class="content">The LP2PDataChannel Interface</span></a>
     <ol class="toc">
      <li><a href="#lp2p-data-channel-init"><span class="secno">9.1</span> <span class="content">LP2PDataChannelInit</span></a>
      <li><a href="#lp2p-data-channel-events"><span class="secno">9.2</span> <span class="content">Events</span></a>
      <li><a href="#lp2p-data-channel-event-handlers"><span class="secno">9.3</span> <span class="content">Event handlers</span></a>
      <li><a href="#lp2p-connection-data-channel-extensions"><span class="secno">9.4</span> <span class="content">LP2PConnection Interface Extensions</span></a>
      <li><a href="#lp2p-data-channel-event"><span class="secno">9.5</span> <span class="content">LP2PDataChannelEvent</span></a>
      <li><a href="#lp2p-connection-data-channel-extensions-events"><span class="secno">9.6</span> <span class="content">Extensions Events</span></a>
      <li><a href="#lp2p-connection-data-channel-extensions-event-handlers"><span class="secno">9.7</span> <span class="content">Extensions Event handlers</span></a>
      <li><a href="#data-channel-communication-examples"><span class="secno">9.8</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#lp2p-quic-transport"><span class="secno">10</span> <span class="content">The LP2PQuicTransport Interface</span></a>
     <ol class="toc">
      <li><a href="#lp2p-quic-transport-listener"><span class="secno">10.1</span> <span class="content">LP2PQuicTransportListener Interface</span></a>
      <li><a href="#lp2p-quic-transport-examples"><span class="secno">10.2</span> <span class="content">Examples</span></a>
     </ol>
    <li>
     <a href="#security-and-privacy-considerations"><span class="secno">11</span> <span class="content">Security and privacy considerations</span></a>
     <ol class="toc">
      <li><a href="#security-osp"><span class="secno">11.1</span> <span class="content">Open Screen Protocol</span></a>
      <li><a href="#security-pii"><span class="secno">11.2</span> <span class="content">Personally identifiable information</span></a>
      <li><a href="#security-ui"><span class="secno">11.3</span> <span class="content">User interface guidelines</span></a>
      <li><a href="#security-same-origin"><span class="secno">11.4</span> <span class="content">Impact on same-origin policy</span></a>
      <li><a href="#security-device-access"><span class="secno">11.5</span> <span class="content">Device Access</span></a>
      <li><a href="#security-persistent-state"><span class="secno">11.6</span> <span class="content">Persistent State</span></a>
      <li><a href="#security-secure-context"><span class="secno">11.7</span> <span class="content">Secure Contexts</span></a>
     </ol>
    <li><a href="#appendix-a"><span class="secno"></span> <span class="content">Appendix A: OSP Extension Messages</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p class="note" role="note"><span class="marker">Note:</span> This specification is under active development and therefore incomplete. If you’re looking for an overview of the proposal, please refer to the <a href="https://github.com/WICG/local-peer-to-peer/blob/main/EXPLAINER.md">Explainer</a>.</p>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is non-normative.</em></p>
   <p>The Local Peer-to-Peer API aims to give browsers the means to communicate directly, without the aid of a server in the middle. It is designed to enable this communication within the confines of a local communication medium such as the Local Area Network.</p>
   <p>Many modern Web security measures rely on the presence of naming, signaling and certificate authorities. Local use-cases where these authorities are not readily available have started lagging behind in user experience or are not supported altogether. The Local Peer-to-Peer API aims to bring back first-class support for local communication use-cases while working within the same strict user-friendliness, security and privacy requirements.</p>
   <p>Examples of potential uses of this API include: Collaboration tools that work during an internet outage or emergency situations, connecting to your NAS, your home security system, your robotic assistant doing the dishes or your GPU farm in the basement that’s running your personalized virtual assistant. See also <a href="https://github.com/WICG/local-peer-to-peer/blob/main/EXPLAINER.md#use-cases">Use Cases</a>.</p>
   <p>This specification aims to strike a balance between creating a powerful new building block for developers and providing a seamless, secure and privacy preserving experience for browser users. As an example: while the API doesn’t provide raw socket access, it does aim to give developers the flexibility to innovate on top by providing a persistent, two-way communication channel with little overhead.</p>
   <p>The API is designed to be backed by an authenticated, streams-based transport. As a commitment to an open standards-based implementation path, this specification describes how the API can be implemented on top of the <a href="https://w3c.github.io/openscreenprotocol/">Open Screen Protocol</a>. While not described here, the API is expected to be implementable on top of other transports when technically feasible.</p>
   <h2 class="heading settled" data-level="2" id="permission-policy-integration"><span class="secno">2. </span><span class="content">Permission Policy Integration</span><a class="self-link" href="#permission-policy-integration"></a></h2>
   <p>The Local Peer-to-Peer API defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the token "local-peer-to-peer". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" id="ref-for-policy-controlled-feature-default-allowlist">default allowlist</a> is <code>"self"</code>.</p>
   <p>Workers (dedicated and shared) adhere to the permission policy set by their owning document(s):</p>
   <ul>
    <li> Dedicated workers can be created from other workers, in which case the permission policy of the first owning document (in case of a dedicated worker) or owning documents (in case of a shared worker) up the owner chain will be used. 
    <li> Shared workers often have multiple owning documents as they can be obtained by other documents with the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin">same origin</a>. In this case, all owning documents must be <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-use">allowed to use</a> the <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature①">policy-controlled feature</a> defined by this specification. 
   </ul>
   <p class="note" role="note"><span class="marker">Note:</span> There has been discussion on allowing setting permission policy directly on a worker on creation, in which case that would have to be consulted as well.</p>
   <p>The <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist" id="ref-for-policy-controlled-feature-default-allowlist①">default allowlist</a> of <code>"self"</code> allows usage in same-origin nested frames but prevents third-party content from using the feature. Third-party content usage can be selectively enabled by adding <code>allow="local-peer-to-peer"</code> attribute to the frame container element:</p>
<pre class="example highlight" id="example-d4e3a73f" title="Enabling Local Peer-to-Peer API on third-party content"><a class="self-link" href="#example-d4e3a73f"></a><c- o>&lt;</c->iframe src<c- o>=</c-><c- u>"https://third-party.com"</c-> allow<c- o>=</c-><c- u>"local-peer-to-peer"</c-><c- o>/>&lt;</c->/iframe>
</pre>
   <p>Alternatively, the Local Peer-to-Peer API can be disabled completely by specifying the permissions policy in a HTTP response header:</p>
<pre class="example highlight" id="example-166d9f7d" title="Permission Policy over HTTP"><a class="self-link" href="#example-166d9f7d"></a>Permissions<c- o>-</c->Policy<c- o>:</c-> local<c- o>-</c->peer<c- o>-</c->to<c- o>-</c->peer<c- o>=</c-><c- p>()</c->
</pre>
   <p>See <a data-link-type="biblio" href="#biblio-permissions-policy" title="Permissions Policy">[PERMISSIONS-POLICY]</a> for more details.</p>
   <h2 class="heading settled" data-level="3" id="peer-management"><span class="secno">3. </span><span class="content">Peer Management</span><a class="self-link" href="#peer-management"></a></h2>
   <p class="note" role="note"><span class="marker">Note:</span> This section and its subsections use RFC 2119 terminology in a relaxed manner. These sections will be converted into well-defined algorithmic normative prose informed by further implementation experience. For now, this relaxed description better allows for rapid prototyping.</p>
   <p>The user agent is in charge of managing peers.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="peer">peer</dfn> is an equal participants in the network that forms a peer-to-peer network of nodes. These nodes can communicate without the need for a central coordination by a server.</p>
   <p>A user agent has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="local-peer-to-peer-manager">local peer-to-peer manager</dfn> in charge of managing <a data-link-type="dfn" href="#peer" id="ref-for-peer">peers</a>. Its responsibility is to <a data-link-type="dfn" href="#start-local-peer-discovery" id="ref-for-start-local-peer-discovery">start local peer discovery</a>, <a data-link-type="dfn" href="#establish-local-peer-connection" id="ref-for-establish-local-peer-connection">establish local peer connections</a> and <a data-link-type="dfn" href="#acquire-a-local-peer-grant" id="ref-for-acquire-a-local-peer-grant">acquire a local peer grant</a> on a per-origin basis. This is done to avoid exposing information about a user’s local network topology.</p>
   <h3 class="heading settled" data-level="3.1" id="known-peers"><span class="secno">3.1. </span><span class="content">Known peers</span><a class="self-link" href="#known-peers"></a></h3>
   <p>The user agent should maintain a list of peers that it has knowledge of.</p>
   <p>The <a data-link-type="dfn" href="#local-peer-to-peer-manager" id="ref-for-local-peer-to-peer-manager">local peer-to-peer manager</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="known-peers-map">known peers map</dfn>, an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">ordered map</a> of <a data-link-type="dfn" href="#known-peer" id="ref-for-known-peer">known peers</a>. Each <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="known-peer">known peer</dfn> is a <a data-link-type="dfn" href="#peer" id="ref-for-peer①">peer</a> that has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="authentication-state">authentication state</dfn> and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="peer-grant-state">peer grant state</dfn>. The user agent keeps track of the <a data-link-type="dfn" href="#authentication-state" id="ref-for-authentication-state">authentication state</a> per peer and the <a data-link-type="dfn" href="#peer-grant-state" id="ref-for-peer-grant-state">peer grant state</a> per peer, per origin. Unless <a data-link-type="dfn" href="#persisted" id="ref-for-persisted">persisted</a>, both the states are initially false.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#peer-grant-state" id="ref-for-peer-grant-state①">peer grant state</a> is origin-level while the <a data-link-type="dfn" href="#authentication-state" id="ref-for-authentication-state①">authentication state</a> is peer-level. The rationale is to not require the user to undergo authentication multiple times between the same peers. This design may change informed by security and privacy considerations.</p>
   <p class="issue" id="issue-45136692"><a class="self-link" href="#issue-45136692"></a> See also related <a href="https://github.com/wicg/local-peer-to-peer/issues/24">[Issue #wicg/local-peer-to-peer#24]</a></p>
   <p>The user agent may persist known peers, their <a data-link-type="dfn" href="#authentication-state" id="ref-for-authentication-state②">authentication states</a> and/or <a data-link-type="dfn" href="#peer-grant-state" id="ref-for-peer-grant-state②">peer grant states</a>. If the user agent chooses to do so, it must do so in accordance with the <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a> Persistent State rules. Such a peer or its state is said to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="persisted">persisted</dfn>.</p>
   <h3 class="heading settled" data-level="3.2" id="peer-advertisement"><span class="secno">3.2. </span><span class="content">Peer advertisement</span><a class="self-link" href="#peer-advertisement"></a></h3>
   <p>The user agent can make itself discoverable by advertising using the <a data-link-type="dfn" href="#session-advertise-agent" id="ref-for-session-advertise-agent">advertise agent</a> capability.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The user agent must get the user’s explicit consent in order to start advertising.</p>
   <p>When advertising, the user agent must listen for incoming peer connections. In case a connection is received, the peer is added to the <a data-link-type="dfn" href="#known-peers-map" id="ref-for-known-peers-map">known peers map</a>. The user agent must not directly provide access to the incoming peer connection to any origin. Instead, the user agent must prompt to <a href="#peer-grant">grant peer</a> access to the origin that initiated peer advertisement.</p>
   <h3 class="heading settled" data-level="3.3" id="peer-discovery"><span class="secno">3.3. </span><span class="content">Peer discovery</span><a class="self-link" href="#peer-discovery"></a></h3>
   <p>The user agent can discover local peers using the <a data-link-type="dfn" href="#session-discover-agents" id="ref-for-session-discover-agents">discover agents</a> capability.</p>
   <p>When asked to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="start-local-peer-discovery">start local peer discovery</dfn>, the user agent discovers local peers using the <a data-link-type="dfn" href="#session-discover-agents" id="ref-for-session-discover-agents①">discover agents</a> capability.</p>
   <p>If a peer is discovered, the user agent should add it to the <a data-link-type="dfn" href="#known-peers-map" id="ref-for-known-peers-map①">known peers map</a>. The user agent must never expose the full result of peer discovery with an origin. Instead, the user agent must <a data-link-type="dfn" href="#acquire-a-local-peer-grant" id="ref-for-acquire-a-local-peer-grant①">acquire a local peer grant</a> to grant access to a peer for the origin that initiated the peer request.</p>
   <h3 class="heading settled" data-level="3.4" id="peer-authentication"><span class="secno">3.4. </span><span class="content">Peer authentication</span><a class="self-link" href="#peer-authentication"></a></h3>
   <p>The user agent can initiate authentication with a peer using the <a data-link-type="dfn" href="#session-authenticate-an-agent" id="ref-for-session-authenticate-an-agent">authenticate an agent</a> capability.</p>
   <p>When asked to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="authenticate-a-local-peer">authenticate a local peer</dfn>, the user agent must initiate authentication with a local peer using the <a data-link-type="dfn" href="#session-authenticate-an-agent" id="ref-for-session-authenticate-an-agent①">authenticate an agent</a> capability. The peer’s <a data-link-type="dfn" href="#authentication-state" id="ref-for-authentication-state③">authentication state</a> must be set to true if authentication succeeds, otherwise false.</p>
   <p>A peer is said to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="authenticated">authenticated</dfn> when its <a data-link-type="dfn" href="#authentication-state" id="ref-for-authentication-state④">authentication state</a> is true.</p>
   <h3 class="heading settled" data-level="3.5" id="peer-grant"><span class="secno">3.5. </span><span class="content">Peer grant</span><a class="self-link" href="#peer-grant"></a></h3>
   <p>The user agent, with the user’s consent, must <a data-link-type="dfn" href="#acquire-a-local-peer-grant" id="ref-for-acquire-a-local-peer-grant②">acquire a local peer grant</a> for an origin to get access to a peer.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The user agent must get the user’s explicit consent in order to grant an origin access to a peer. For enhanced privacy protection, the user agent must provide means to dismiss any related user interface and this action must not be detectable by script or have script-observable side-effects. The user interface may provide means to revoke the grant or to make the grant <a data-link-type="dfn" href="#persisted" id="ref-for-persisted①">persisted</a>.</p>
   <p>When asked to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="acquire-a-local-peer-grant">acquire a local peer grant</dfn>, the user agent displays the <a data-link-type="dfn" href="#known-peer" id="ref-for-known-peer①">known peers</a> to the user through its native user interface. When the user selects a peer from the user interface, the user agent must check the selected peer is <a data-link-type="dfn" href="#authenticated" id="ref-for-authenticated">authenticated</a>, and run the <a data-link-type="dfn" href="#authenticate-a-local-peer" id="ref-for-authenticate-a-local-peer">authenticate a local peer</a> algorithm otherwise, and set the <a data-link-type="dfn" href="#peer-grant-state" id="ref-for-peer-grant-state③">peer grant state</a> according to the user’s explicit selection.</p>
   <h2 class="heading settled" data-level="4" id="protocol-concepts"><span class="secno">4. </span><span class="content">Protocol concepts</span><a class="self-link" href="#protocol-concepts"></a></h2>
   <p>When asked to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="establish-local-peer-connection">establish local peer connection</dfn>, the user agent ...</p>
   <p>A <dfn class="dfn-paneled" data-dfn-for="protocol" data-dfn-type="dfn" data-noexport id="protocol-local-peer-to-peer-session">Local Peer-to-Peer session</dfn> represents an authenticated <a data-link-type="biblio" href="#biblio-rfc9000" title="QUIC: A UDP-Based Multiplexed and Secure Transport">QUIC</a> connection as defined in <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a> or OSP.</p>
   <p>A <a data-link-type="dfn" href="#protocol-local-peer-to-peer-session" id="ref-for-protocol-local-peer-to-peer-session">Local Peer-to-Peer session</a> has the following capabilities:</p>
   <table class="data">
    <thead>
     <tr>
      <th>capability 
      <th>definition 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-advertise-agent">advertise agent</dfn> 
      <td><a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">[openscreenprotocol]</a> <a href="https://www.w3.org/TR/openscreenprotocol/#discovery">discovery</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-discover-agents">discover agents</dfn> 
      <td><a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">[openscreenprotocol]</a> <a href="https://www.w3.org/TR/openscreenprotocol/#discovery">discovery</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-discover-metadata">discover metadata</dfn> 
      <td><a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">[openscreenprotocol]</a> <a href="https://www.w3.org/TR/openscreenprotocol/#transport">transport</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="session" data-dfn-type="dfn" data-noexport id="session-authenticate-an-agent">authenticate an agent</dfn> 
      <td><a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">[openscreenprotocol]</a> <a href="https://www.w3.org/TR/openscreenprotocol/#authentication">authentication</a> 
     <tr>
      <td><a data-link-type="dfn" href="#open-a-data-channel" id="ref-for-open-a-data-channel">open a data channel</a> 
      <td><a href="#data-channel-extension">§ 4.1 Data channel extension</a> 
     <tr>
      <td><a data-link-type="dfn" href="#send-data-on-a-channel" id="ref-for-send-data-on-a-channel">send data on a channel</a> 
      <td><a href="#data-channel-extension">§ 4.1 Data channel extension</a> 
     <tr>
      <td><a data-link-type="dfn" href="#open-a-webtransport-session" id="ref-for-open-a-webtransport-session">open a WebTransport session</a> 
      <td><a href="#webtransport-extension">§ 4.2 WebTransport extension</a> 
   </table>
   <p>Part of these capabilities are defined below as <a href="https://www.w3.org/TR/openscreenprotocol/#protocol-extensions">protocol extensions</a> to the <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a>.</p>
   <h3 class="heading settled" data-level="4.1" id="data-channel-extension"><span class="secno">4.1. </span><span class="content">Data channel extension</span><a class="self-link" href="#data-channel-extension"></a></h3>
   <p>In order to signal support for this protocol extension, the agent should include the <a data-link-type="dfn" href="#data-channels" id="ref-for-data-channels">data-channels</a> <a data-link-type="dfn" href="#agent-capability" id="ref-for-agent-capability">agent-capability</a> as part of the <a href="https://www.w3.org/TR/openscreenprotocol/#agent-info-response">agent-info-response</a> message exchanged during <a data-link-type="dfn" href="#session-discover-metadata" id="ref-for-session-discover-metadata">discover metadata</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="open-a-data-channel">open a data channel</dfn> an agent may send a <a data-link-type="dfn" href="#data-channel-open-request" id="ref-for-data-channel-open-request">data-channel-open-request</a> message on a new <a data-link-type="biblio" href="#biblio-rfc9000" title="QUIC: A UDP-Based Multiplexed and Secure Transport">QUIC</a> stream. The <a data-link-type="dfn" href="#protocol-local-peer-to-peer-session" id="ref-for-protocol-local-peer-to-peer-session①">Local Peer-to-Peer session</a> must be authenticated. The message must contain the following values:</p>
   <dl>
    <dt data-md>channel-id
    <dd data-md>
     <p>An ID number (between 0 and 65,534) which uniquely identifies the data channel.  Must not be empty.</p>
    <dt data-md>label
    <dd data-md>
     <p>a string that contains a name describing the data channel. These labels are not required to be unique.</p>
    <dt data-md>protocol
    <dd data-md>
     <p>a string containing the name of the subprotocol in use. If no protocol was specified when the data channel was created, then this property’s value is the empty string ("").</p>
   </dl>
   <p>When the receiver receives the <a data-link-type="dfn" href="#data-channel-open-request" id="ref-for-data-channel-open-request①">data-channel-open-request</a>, it should send back a <a data-link-type="dfn" href="#data-channel-open-response" id="ref-for-data-channel-open-response">data-channel-open-response</a> message. The response must include the following:</p>
   <dl>
    <dt data-md>result
    <dd data-md>
     <p>a code indicating success or failure, and the reason for the failure.</p>
   </dl>
   <p>If the <a data-link-type="dfn" href="#data-channel-open-response" id="ref-for-data-channel-open-response①">data-channel-open-response</a> message indicates success, the data channel is considered open. Agents can now <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="send-data-on-a-channel">send data on a channel</dfn> by sending <a data-link-type="dfn" href="#data-frame" id="ref-for-data-frame">data-frame</a> messages on the same <a data-link-type="biblio" href="#biblio-rfc9000" title="QUIC: A UDP-Based Multiplexed and Secure Transport">QUIC</a> stream the data channel was opened. The message must include the following:</p>
   <dl>
    <dt data-md>encoding-id
    <dd data-md>
     <p>Determines the encoding of the data being sent. The values are specified as <a data-link-type="dfn" href="#data-channel-encoding-id" id="ref-for-data-channel-encoding-id">data-channel-encoding-id</a>:
0: <a data-link-type="dfn" href="#encoding-id-blob" id="ref-for-encoding-id-blob">Blob</a>;
1: <a data-link-type="dfn" href="#encoding-id-string" id="ref-for-encoding-id-string">String</a>;
2: <a data-link-type="dfn" href="#encoding-id-array-buffer" id="ref-for-encoding-id-array-buffer">ArrayBuffer</a>.</p>
    <dt data-md>payload
    <dd data-md>
     <p>The binary representation of the data being sent.</p>
   </dl>
   <h3 class="heading settled" data-level="4.2" id="webtransport-extension"><span class="secno">4.2. </span><span class="content">WebTransport extension</span><a class="self-link" href="#webtransport-extension"></a></h3>
   <p>The protocol extension to <a data-link-type="dfn" href="#send-data-on-a-channel" id="ref-for-send-data-on-a-channel①">send data on a channel</a> provides an ergonomic way to send simple messages. An agent can <a data-link-type="dfn" href="#open-a-webtransport-session" id="ref-for-open-a-webtransport-session①">open a WebTransport session</a> for communication that requires low overhead and more granular streams control.</p>
   <p>In order to signal support for this protocol extension, the agent should include the <a data-link-type="dfn" href="#quick-transport" id="ref-for-quick-transport">quick-transport</a> <a data-link-type="dfn" href="#agent-capability" id="ref-for-agent-capability①">agent-capability</a> as part of the <a href="https://www.w3.org/TR/openscreenprotocol/#agent-info-response">agent-info-response</a> message exchanged during <a data-link-type="dfn" href="#session-discover-metadata" id="ref-for-session-discover-metadata①">discover metadata</a>.</p>
   <p>An agent can <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="open-a-webtransport-session">open a WebTransport session</dfn> by dialing a new <a data-link-type="biblio" href="#biblio-rfc9000" title="QUIC: A UDP-Based Multiplexed and Secure Transport">QUIC</a> connection using the agent certificates established during <a data-link-type="dfn" href="#session-authenticate-an-agent" id="ref-for-session-authenticate-an-agent②">authenticate an agent</a>. During connection establishment, the ALPN token "q2q" must be used in the TLS handshake.</p>
   <p>The capabilities of the Local WebTransport session are defined in <a data-link-type="biblio" href="#biblio-webtransport" title="WebTransport">[webtransport]</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The WebTransport-over-QUIC protocol is yet to be defined. Potentially considering earlier work such as <a href="https://datatracker.ietf.org/doc/html/draft-vvv-webtransport-quic-02">draft-vvv-webtransport-quic</a>.</p>
   <section class="algorithm" data-algorithm="LP2PReceiver">
    <h2 class="heading settled" data-level="5" id="local-https"><span class="secno">5. </span><span class="content">Local HTTPS</span><a class="self-link" href="#local-https"></a></h2>
    <p>Authentication establishes a mutual trust anchor between peers on the local network. This trust anchor can also be used to validate certificates used by HTTP servers on the local network. An Open Screen Protocol agent certificate can be identified by the common name of its subject ending in "._openscreen._udp". When a user agent loads a webpage and finds an agent certificate in the certificate chain, it can use it as a trust anchor for authentication of the server. If the corresponding agent is not <a data-link-type="dfn" href="#authenticated" id="ref-for-authenticated①">authenticated</a>, the user agent should prompt the user to authenticate the agent before proceeding with certificate validation.</p>
    <h3 class="heading settled" data-level="5.1" id="local-https-discovery"><span class="secno">5.1. </span><span class="content">Endpoint discovery</span><a class="self-link" href="#local-https-discovery"></a></h3>
     If a peer is <a data-link-type="dfn" href="#authenticated" id="ref-for-authenticated②">authenticated</a>, it may advertize one or more HTTPS endpoints it provides. A user agent may display these to the user to connect to servers on the local network without knowledge of the corresponding hostname and/or IP address. 
    <p class="issue" id="issue-bea8fec9"><a class="self-link" href="#issue-bea8fec9"></a> define endpoint-info messages</p>
    <h2 class="heading settled" data-level="6" id="lp2p-receiver"><span class="secno">6. </span><span class="content">LP2PReceiver Interface</span><a class="self-link" href="#lp2p-receiver"></a></h2>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2preceiver"><code>LP2PReceiver</code></dfn> interface allows advertising on the local network, enabling other peers to discover and connect.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2preceiver" id="ref-for-lp2preceiver"><c- g>LP2PReceiver</c-></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiver" data-dfn-type="constructor" data-export data-lt="LP2PReceiver(options)|constructor(options)|LP2PReceiver()|constructor()" id="dom-lp2preceiver-lp2preceiver"><code><c- g>constructor</c-></code></dfn>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2preceiveroptions" id="ref-for-dictdef-lp2preceiveroptions"><c- n>LP2PReceiverOptions</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiver/LP2PReceiver(options), LP2PReceiver/constructor(options), LP2PReceiver/LP2PReceiver(), LP2PReceiver/constructor()" data-dfn-type="argument" data-export id="dom-lp2preceiver-lp2preceiver-options-options"><code><c- g>options</c-></code></dfn> = {});
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2preceiver-onconnection" id="ref-for-dom-lp2preceiver-onconnection"><c- g>onconnection</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiver" data-dfn-type="method" data-export data-lt="start()" id="dom-lp2preceiver-start"><code><c- g>start</c-></code></dfn>();
};
</pre>
    <h3 class="heading settled" data-level="6.1" id="lp2p-receiver-options"><span class="secno">6.1. </span><span class="content">LP2PReceiverOptions</span><a class="self-link" href="#lp2p-receiver-options"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2preceiveroptions"><code><c- g>LP2PReceiverOptions</c-></code></dfn> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiverOptions" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-lp2preceiveroptions-nickname"><code><c- g>nickname</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="6.2" id="lp2p-receiver-connection-event"><span class="secno">6.2. </span><span class="content">LP2PConnectionEvent</span><a class="self-link" href="#lp2p-receiver-connection-event"></a></h3>
    <p class="issue" id="issue-2e09a0e3"><a class="self-link" href="#issue-2e09a0e3"></a> In general, when defining a new interface that inherits from Event please always ask feedback from the WHATWG or the W3C WebApps WG community. See <a href="https://dom.spec.whatwg.org/#defining-event-interfaces">defining event interfaces</a>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext②"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pconnectionevent"><code><c- g>LP2PConnectionEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event"><c- n>Event</c-></a> {
    <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnectionEvent" data-dfn-type="constructor" data-export data-lt="LP2PConnectionEvent(type, connectionEventInitDict)|constructor(type, connectionEventInitDict)" id="dom-lp2pconnectionevent-lp2pconnectionevent"><code><c- g>constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnectionEvent/LP2PConnectionEvent(type, connectionEventInitDict), LP2PConnectionEvent/constructor(type, connectionEventInitDict)" data-dfn-type="argument" data-export id="dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-type"><code><c- g>type</c-></code></dfn>, <a data-link-type="idl-name" href="#dictdef-lp2pconnectioneventinit" id="ref-for-dictdef-lp2pconnectioneventinit"><c- n>LP2PConnectionEventInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnectionEvent/LP2PConnectionEvent(type, connectionEventInitDict), LP2PConnectionEvent/constructor(type, connectionEventInitDict)" data-dfn-type="argument" data-export id="dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-connectioneventinitdict"><code><c- g>connectionEventInitDict</c-></code></dfn>);
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#lp2pconnection" id="ref-for-lp2pconnection"><c- n>LP2PConnection</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnectionEvent" data-dfn-type="attribute" data-export data-readonly data-type="LP2PConnection" id="dom-lp2pconnectionevent-connection"><code><c- g>connection</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2pconnectioneventinit"><code><c- g>LP2PConnectionEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a data-link-type="idl-name" href="#lp2pconnection" id="ref-for-lp2pconnection①"><c- n>LP2PConnection</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnectionEventInit" data-dfn-type="dict-member" data-export data-type="LP2PConnection " id="dom-lp2pconnectioneventinit-connection"><code><c- g>connection</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="6.3" id="lp2p-receiver-events"><span class="secno">6.3. </span><span class="content">Events</span><a class="self-link" href="#lp2p-receiver-events"></a></h3>
    <p>The following event is <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire">fired</a> at the <code class="idl"><a data-link-type="idl" href="#lp2preceiver" id="ref-for-lp2preceiver①">LP2PReceiver</a></code> object:</p>
    <table class="data">
     <thead>
      <tr>
       <th>Event name
       <th>Interface
       <th>Fired when…
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiver" data-dfn-type="event" data-export id="eventdef-lp2preceiver-connection"><code>connection</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#lp2pconnectionevent" id="ref-for-lp2pconnectionevent">LP2PConnectionEvent</a></code>
       <td>An incoming connection is received.
    </table>
    <h3 class="heading settled" data-level="6.4" id="lp2p-receiver-event-handlers"><span class="secno">6.4. </span><span class="content">Event handlers</span><a class="self-link" href="#lp2p-receiver-event-handlers"></a></h3>
    <p>The following are the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers">event handlers</a> (and their corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type">event handler event types</a>) that must be supported, as <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes" id="ref-for-event-handler-idl-attributes">event handler IDL attributes</a>, by all objects implementing the <a href="#lp2p-receiver">LP2PReceiver</a> interface:</p>
    <table class="data">
     <thead>
      <tr>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers①">event handler</a>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type①">event handler event type</a>
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PReceiver" data-dfn-type="attribute" data-export id="dom-lp2preceiver-onconnection"><code>onconnection</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2preceiver-connection" id="ref-for-eventdef-lp2preceiver-connection">connection</a></code>
    </table>
    <h3 class="heading settled" data-level="6.5" id="lp2p-receiver-examples"><span class="secno">6.5. </span><span class="content">Examples</span><a class="self-link" href="#lp2p-receiver-examples"></a></h3>
    <p>Example: Setting up a receiver to listen for connections:</p>
<pre class="example highlight" id="example-b0ad794d"><a class="self-link" href="#example-b0ad794d"></a><c- a>const</c-> receiver <c- o>=</c-> <c- ow>new</c-> LP2PReceiver<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-receiver"</c-><c- p>,</c->
<c- p>});</c->
receiver<c- p>.</c->onconnection <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
    console<c- p>.</c->log<c- p>(</c-><c- u>"Connection established!"</c-><c- p>);</c->
    <c- a>const</c-> conn <c- o>=</c-> e<c- p>.</c->connection<c- p>;</c->
<c- p>};</c->

<c- c1>// Blocks until permission is received.</c->
<c- k>await</c-> receiver<c- p>.</c->start<c- p>();</c->
</pre>
   </section>
   <section class="algorithm" data-algorithm="LP2PRequest">
    <h2 class="heading settled" data-level="7" id="lp2p-request"><span class="secno">7. </span><span class="content">The LP2PRequest Interface</span><a class="self-link" href="#lp2p-request"></a></h2>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2prequest"><code>LP2PRequest</code></dfn> interface represents a request for a connection to another local peer.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext③"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2prequest" id="ref-for-lp2prequest"><c- g>LP2PRequest</c-></a> {
    <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PRequest" data-dfn-type="constructor" data-export data-lt="LP2PRequest(options)|constructor(options)|LP2PRequest()|constructor()" id="dom-lp2prequest-lp2prequest"><code><c- g>constructor</c-></code></dfn>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2prequestoptions" id="ref-for-dictdef-lp2prequestoptions"><c- n>LP2PRequestOptions</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PRequest/LP2PRequest(options), LP2PRequest/constructor(options), LP2PRequest/LP2PRequest(), LP2PRequest/constructor()" data-dfn-type="argument" data-export id="dom-lp2prequest-lp2prequest-options-options"><code><c- g>options</c-></code></dfn> = {});
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#lp2pconnection" id="ref-for-lp2pconnection②"><c- n>LP2PConnection</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PRequest" data-dfn-type="method" data-export data-lt="start()" id="dom-lp2prequest-start"><code><c- g>start</c-></code></dfn>();
};
</pre>
    <h3 class="heading settled" data-level="7.1" id="lp2p-request-options"><span class="secno">7.1. </span><span class="content">LP2PRequestOptions</span><a class="self-link" href="#lp2p-request-options"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext④"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2prequestoptions"><code><c- g>LP2PRequestOptions</c-></code></dfn> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PRequestOptions" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-lp2prequestoptions-nickname"><code><c- g>nickname</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="7.2" id="lp2p-request-examples"><span class="secno">7.2. </span><span class="content">Examples</span><a class="self-link" href="#lp2p-request-examples"></a></h3>
    <p>Example: Setting up a request for a connection:</p>
<pre class="example highlight" id="example-435ab8e1"><a class="self-link" href="#example-435ab8e1"></a><c- a>const</c-> request <c- o>=</c-> <c- ow>new</c-> LP2PRequest<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-request"</c-><c- p>,</c->
<c- p>});</c->

<c- c1>// Blocks until connection is received.</c->
<c- a>const</c-> conn <c- o>=</c-> <c- k>await</c-> request<c- p>.</c->start<c- p>();</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"Connection established!"</c-><c- p>);</c->
</pre>
   </section>
   <section class="algorithm" data-algorithm="LP2PConnection">
    <h2 class="heading settled" data-level="8" id="lp2p-connection"><span class="secno">8. </span><span class="content">The LP2PConnection Interface</span><a class="self-link" href="#lp2p-connection"></a></h2>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pconnection"><code>LP2PConnection</code></dfn> interface represents a connection with another local peer.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑤"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pconnection" id="ref-for-lp2pconnection③"><c- g>LP2PConnection</c-></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget①"><c- n>EventTarget</c-></a> {
};
</pre>
    <h3 class="heading settled" data-level="8.1" id="lp2p-connection-quic-transport-extensions"><span class="secno">8.1. </span><span class="content">LP2PQuicTransport Interface Extensions</span><a class="self-link" href="#lp2p-connection-quic-transport-extensions"></a></h3>
    <p>This <code class="idl"><a data-link-type="idl" href="#lp2pquictransport" id="ref-for-lp2pquictransport">LP2PQuicTransport</a></code> extension allows opening a QuicTransport using an existing connection. In this case, the already established permission and grants should be used.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑥"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransport" id="ref-for-lp2pquictransport①"><c- g>LP2PQuicTransport</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport" data-dfn-type="constructor" data-export data-lt="LP2PQuicTransport(connection, quicTransportDict)|constructor(connection, quicTransportDict)|LP2PQuicTransport(connection)|constructor(connection)" id="dom-lp2pquictransport-lp2pquictransport"><code><c- g>constructor</c-></code></dfn>(<a data-link-type="idl-name" href="#lp2pconnection" id="ref-for-lp2pconnection④"><c- n>LP2PConnection</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport/LP2PQuicTransport(connection, quicTransportDict), LP2PQuicTransport/constructor(connection, quicTransportDict), LP2PQuicTransport/LP2PQuicTransport(connection), LP2PQuicTransport/constructor(connection)" data-dfn-type="argument" data-export id="dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-connection"><code><c- g>connection</c-></code></dfn>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportinit" id="ref-for-dictdef-lp2pquictransportinit"><c- n>LP2PQuicTransportInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport/LP2PQuicTransport(connection, quicTransportDict), LP2PQuicTransport/constructor(connection, quicTransportDict), LP2PQuicTransport/LP2PQuicTransport(connection), LP2PQuicTransport/constructor(connection)" data-dfn-type="argument" data-export id="dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-quictransportdict"><code><c- g>quicTransportDict</c-></code></dfn> = {});
};
</pre>
    <h3 class="heading settled" data-level="8.2" id="lp2p-connection-examples"><span class="secno">8.2. </span><span class="content">Examples</span><a class="self-link" href="#lp2p-connection-examples"></a></h3>
    <p>Example: Open a <code class="idl"><a data-link-type="idl" href="#lp2pquictransport" id="ref-for-lp2pquictransport②">LP2PQuicTransport</a></code> using an existing connection as receiver:</p>
<pre class="example highlight" id="example-99f94727"><a class="self-link" href="#example-99f94727"></a><c- a>const</c-> receiver <c- o>=</c-> <c- ow>new</c-> LP2PReceiver<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-receiver"</c-><c- p>,</c->
<c- p>});</c->
receiver<c- p>.</c->onconnection <c- o>=</c-> <c- k>async</c-> e <c- p>=></c-> <c- p>{</c->
    <c- a>const</c-> conn <c- o>=</c-> e<c- p>.</c->connection<c- p>;</c->
    
    <c- a>const</c-> transport <c- o>=</c-> <c- ow>new</c-> LP2PQuicTransport<c- p>(</c->conn<c- p>);</c->

    <c- c1>// Blocks until transport is ready.</c->
    <c- k>await</c-> transport<c- p>.</c->ready<c- p>;</c->
<c- p>};</c->

<c- c1>// Blocks until permission is received.</c->
<c- k>await</c-> receiver<c- p>.</c->start<c- p>();</c->
</pre>
    <p>Example: Open a <code class="idl"><a data-link-type="idl" href="#lp2pquictransport" id="ref-for-lp2pquictransport③">LP2PQuicTransport</a></code> using an existing connection as requester:</p>
<pre class="example highlight" id="example-e4c251ab"><a class="self-link" href="#example-e4c251ab"></a><c- a>const</c-> request <c- o>=</c-> <c- ow>new</c-> LP2PRequest<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-request"</c-><c- p>,</c->
<c- p>});</c->

<c- c1>// Blocks until connection is received.</c->
<c- a>const</c-> conn <c- o>=</c-> <c- k>await</c-> request<c- p>.</c->start<c- p>();</c->

<c- a>const</c-> transport <c- o>=</c-> <c- ow>new</c-> LP2PQuicTransport<c- p>(</c->conn<c- p>);</c->

<c- c1>// Blocks until transport is ready.</c->
<c- k>await</c-> transport<c- p>.</c->ready<c- p>;</c->
</pre>
   </section>
   <section class="algorithm" data-algorithm="LP2PDataChannel">
    <h2 class="heading settled" data-level="9" id="lp2p-data-channel"><span class="secno">9. </span><span class="content">The LP2PDataChannel Interface</span><a class="self-link" href="#lp2p-data-channel"></a></h2>
    <p>The LP2PDataChannel interface represents a bi-directional data channel between two peers. An LP2PDataChannel is created via a <a href="#lp2p-connection-data-channel-extensions">factory method</a> on a LP2PConnection object.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The LP2PDataChannel interface is purposefully kept as close as possible to the <a href="https://www.w3.org/TR/webrtc/#rtcdatachannel">RTCDataChannel</a> interface defined in <a data-link-type="biblio" href="#biblio-webrtc" title="WebRTC: Real-Time Communication in Browsers">[webrtc]</a>. The aim is to allow seamless transition of developers that are familiar with WebRTC as well as allowing libraries to easily work with both the <a data-link-type="biblio" href="#biblio-webrtc" title="WebRTC: Real-Time Communication in Browsers">[webrtc]</a> and LP2P API.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑦"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pdatachannel"><code><c- g>LP2PDataChannel</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget②"><c- n>EventTarget</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="constructor" data-export data-lt="LP2PDataChannel(label, dataChannelDict)|constructor(label, dataChannelDict)|LP2PDataChannel(label)|constructor(label)" id="dom-lp2pdatachannel-lp2pdatachannel"><code><c- g>constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel/LP2PDataChannel(label, dataChannelDict), LP2PDataChannel/constructor(label, dataChannelDict), LP2PDataChannel/LP2PDataChannel(label), LP2PDataChannel/constructor(label)" data-dfn-type="argument" data-export id="dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-label"><code><c- g>label</c-></code></dfn>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pdatachannelinit" id="ref-for-dictdef-lp2pdatachannelinit"><c- n>LP2PDataChannelInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel/LP2PDataChannel(label, dataChannelDict), LP2PDataChannel/constructor(label, dataChannelDict), LP2PDataChannel/LP2PDataChannel(label), LP2PDataChannel/constructor(label)" data-dfn-type="argument" data-export id="dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-datachanneldict"><code><c- g>dataChannelDict</c-></code></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-lp2pdatachannel-label"><code><c- g>label</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-lp2pdatachannel-protocol"><code><c- g>protocol</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export data-readonly data-type="unsigned short?" id="dom-lp2pdatachannel-id"><code><c- g>id</c-></code></dfn>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler①"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onopen" id="ref-for-dom-lp2pdatachannel-onopen"><c- g>onopen</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler②"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onerror" id="ref-for-dom-lp2pdatachannel-onerror"><c- g>onerror</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler③"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onclosing" id="ref-for-dom-lp2pdatachannel-onclosing"><c- g>onclosing</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler④"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onclose" id="ref-for-dom-lp2pdatachannel-onclose"><c- g>onclose</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="method" data-export data-lt="close()" id="dom-lp2pdatachannel-close"><code><c- g>close</c-></code></dfn>();
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑤"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onmessage" id="ref-for-dom-lp2pdatachannel-onmessage"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://websockets.spec.whatwg.org/#enumdef-binarytype" id="ref-for-enumdef-binarytype"><c- n>BinaryType</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export data-type="BinaryType" id="dom-lp2pdatachannel-binarytype"><code><c- g>binaryType</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined②"><c- b>undefined</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="method" data-export data-lt="send(data)" id="dom-lp2pdatachannel-send"><code><c- g>send</c-></code></dfn>((<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://w3c.github.io/FileAPI/#dfn-Blob" id="ref-for-dfn-Blob"><c- n>Blob</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer"><c- b>ArrayBuffer</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#ArrayBufferView" id="ref-for-ArrayBufferView"><c- n>ArrayBufferView</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel/send(data)" data-dfn-type="argument" data-export id="dom-lp2pdatachannel-send-data-data"><code><c- g>data</c-></code></dfn>);
};
</pre>
    <h3 class="heading settled" data-level="9.1" id="lp2p-data-channel-init"><span class="secno">9.1. </span><span class="content">LP2PDataChannelInit</span><a class="self-link" href="#lp2p-data-channel-init"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑧"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑧"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2pdatachannelinit"><code><c- g>LP2PDataChannelInit</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="LP2PDataChannelInit" data-dfn-type="dict-member" data-export data-type="USVString " id="dom-lp2pdatachannelinit-protocol"><code><c- g>protocol</c-></code></dfn> = "";
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange" id="ref-for-EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short①"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelInit" data-dfn-type="dict-member" data-export data-type="unsigned short " id="dom-lp2pdatachannelinit-id"><code><c- g>id</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="9.2" id="lp2p-data-channel-events"><span class="secno">9.2. </span><span class="content">Events</span><a class="self-link" href="#lp2p-data-channel-events"></a></h3>
    <p>The following event is <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire①">fired</a> at the <code class="idl"><a data-link-type="idl" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel">LP2PDataChannel</a></code> object:</p>
    <table class="data">
     <thead>
      <tr>
       <th>Event name
       <th>Interface
       <th>Fired when…
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="event" data-export id="eventdef-lp2pdatachannel-open"><code>open</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event①">Event</a></code>
       <td>The data channel is opened.
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="event" data-export id="eventdef-lp2pdatachannel-message"><code>message</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/comms.html#messageevent" id="ref-for-messageevent">MessageEvent</a></code><a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[html]</a>
       <td>An incoming message is received.
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="event" data-export id="eventdef-lp2pdatachannel-error"><code>error</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event②">Event</a></code>
       <td>An error occurred.
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="event" data-export id="eventdef-lp2pdatachannel-closing"><code>closing</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event③">Event</a></code>
       <td>The data channel is closing.
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="event" data-export id="eventdef-lp2pdatachannel-close"><code>close</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event④">Event</a></code>
       <td>The data channel is closed.
    </table>
    <h3 class="heading settled" data-level="9.3" id="lp2p-data-channel-event-handlers"><span class="secno">9.3. </span><span class="content">Event handlers</span><a class="self-link" href="#lp2p-data-channel-event-handlers"></a></h3>
    <p>The following are the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers②">event handlers</a> (and their corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type②">event handler event types</a>) that must be supported, as <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes" id="ref-for-event-handler-idl-attributes①">event handler IDL attributes</a>, by all objects implementing the <a href="#lp2p-data-channel">LP2PDataChannel</a> interface:</p>
    <table class="data">
     <thead>
      <tr>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers③">event handler</a>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type③">event handler event type</a>
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export id="dom-lp2pdatachannel-onopen"><code>onopen</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pdatachannel-open" id="ref-for-eventdef-lp2pdatachannel-open">open</a></code>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export id="dom-lp2pdatachannel-onmessage"><code>onmessage</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pdatachannel-message" id="ref-for-eventdef-lp2pdatachannel-message">message</a></code>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export id="dom-lp2pdatachannel-onerror"><code>onerror</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pdatachannel-error" id="ref-for-eventdef-lp2pdatachannel-error">error</a></code>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export id="dom-lp2pdatachannel-onclosing"><code>onclosing</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pdatachannel-closing" id="ref-for-eventdef-lp2pdatachannel-closing">closing</a></code>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannel" data-dfn-type="attribute" data-export id="dom-lp2pdatachannel-onclose"><code>onclose</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pdatachannel-close" id="ref-for-eventdef-lp2pdatachannel-close">close</a></code>
    </table>
    <h3 class="heading settled" data-level="9.4" id="lp2p-connection-data-channel-extensions"><span class="secno">9.4. </span><span class="content">LP2PConnection Interface Extensions</span><a class="self-link" href="#lp2p-connection-data-channel-extensions"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑨"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext⑨"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pconnection" id="ref-for-lp2pconnection⑤"><c- g>LP2PConnection</c-></a> {
  <a data-link-type="idl-name" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel①"><c- n>LP2PDataChannel</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnection" data-dfn-type="method" data-export data-lt="createDataChannel(label, dataChannelDict)|createDataChannel(label)" id="dom-lp2pconnection-createdatachannel"><code><c- g>createDataChannel</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnection/createDataChannel(label, dataChannelDict), LP2PConnection/createDataChannel(label)" data-dfn-type="argument" data-export id="dom-lp2pconnection-createdatachannel-label-datachanneldict-label"><code><c- g>label</c-></code></dfn>,
                                    <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pdatachannelinit" id="ref-for-dictdef-lp2pdatachannelinit①"><c- n>LP2PDataChannelInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnection/createDataChannel(label, dataChannelDict), LP2PConnection/createDataChannel(label)" data-dfn-type="argument" data-export id="dom-lp2pconnection-createdatachannel-label-datachanneldict-datachanneldict"><code><c- g>dataChannelDict</c-></code></dfn> = {});
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler⑥"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pconnection-ondatachannel" id="ref-for-dom-lp2pconnection-ondatachannel"><c- g>ondatachannel</c-></a>;
};
</pre>
    <h3 class="heading settled" data-level="9.5" id="lp2p-data-channel-event"><span class="secno">9.5. </span><span class="content">LP2PDataChannelEvent</span><a class="self-link" href="#lp2p-data-channel-event"></a></h3>
    <p class="issue" id="issue-2e09a0e3①"><a class="self-link" href="#issue-2e09a0e3①"></a> In general, when defining a new interface that inherits from Event please always ask feedback from the WHATWG or the W3C WebApps WG community. See <a href="https://dom.spec.whatwg.org/#defining-event-interfaces">defining event interfaces</a>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①⓪"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①⓪"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pdatachannelevent"><code><c- g>LP2PDataChannelEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event⑤"><c- n>Event</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelEvent" data-dfn-type="constructor" data-export data-lt="LP2PDataChannelEvent(type, DataChannelEventInitDict)|constructor(type, DataChannelEventInitDict)" id="dom-lp2pdatachannelevent-lp2pdatachannelevent"><code><c- g>constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelEvent/LP2PDataChannelEvent(type, DataChannelEventInitDict), LP2PDataChannelEvent/constructor(type, DataChannelEventInitDict)" data-dfn-type="argument" data-export id="dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-type"><code><c- g>type</c-></code></dfn>, <a data-link-type="idl-name" href="#dictdef-lp2pdatachanneleventinit" id="ref-for-dictdef-lp2pdatachanneleventinit"><c- n>LP2PDataChannelEventInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelEvent/LP2PDataChannelEvent(type, DataChannelEventInitDict), LP2PDataChannelEvent/constructor(type, DataChannelEventInitDict)" data-dfn-type="argument" data-export id="dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-datachanneleventinitdict"><code><c- g>DataChannelEventInitDict</c-></code></dfn>);
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel②"><c- n>LP2PDataChannel</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelEvent" data-dfn-type="attribute" data-export data-readonly data-type="LP2PDataChannel" id="dom-lp2pdatachannelevent-channel"><code><c- g>channel</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2pdatachanneleventinit"><code><c- g>LP2PDataChannelEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit①"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a data-link-type="idl-name" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel③"><c- n>LP2PDataChannel</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PDataChannelEventInit" data-dfn-type="dict-member" data-export data-type="LP2PDataChannel " id="dom-lp2pdatachanneleventinit-channel"><code><c- g>channel</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="9.6" id="lp2p-connection-data-channel-extensions-events"><span class="secno">9.6. </span><span class="content">Extensions Events</span><a class="self-link" href="#lp2p-connection-data-channel-extensions-events"></a></h3>
    <p>The following event is <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire②">fired</a> at the <code class="idl"><a data-link-type="idl" href="#lp2pconnection" id="ref-for-lp2pconnection⑥">LP2PConnection</a></code> object:</p>
    <table class="data">
     <thead>
      <tr>
       <th>Event name
       <th>Interface
       <th>Fired when…
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnection" data-dfn-type="event" data-export id="eventdef-lp2pconnection-datachannel"><code>datachannel</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#lp2pdatachannelevent" id="ref-for-lp2pdatachannelevent">LP2PDataChannelEvent</a></code>
       <td>An incoming data channel is received.
    </table>
    <h3 class="heading settled" data-level="9.7" id="lp2p-connection-data-channel-extensions-event-handlers"><span class="secno">9.7. </span><span class="content">Extensions Event handlers</span><a class="self-link" href="#lp2p-connection-data-channel-extensions-event-handlers"></a></h3>
    <p>The following are the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers④">event handlers</a> (and their corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type④">event handler event types</a>) that must be supported, as <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes" id="ref-for-event-handler-idl-attributes②">event handler IDL attributes</a>, by all objects implementing the <code class="idl"><a data-link-type="idl" href="#lp2pconnection" id="ref-for-lp2pconnection⑦">LP2PConnection</a></code> interface:</p>
    <table class="data">
     <thead>
      <tr>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers" id="ref-for-event-handlers⑤">event handler</a>
       <th><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type" id="ref-for-event-handler-event-type⑤">event handler event type</a>
     <tbody>
      <tr>
       <td><dfn class="dfn-paneled idl-code" data-dfn-for="LP2PConnection" data-dfn-type="attribute" data-export id="dom-lp2pconnection-ondatachannel"><code>ondatachannel</code></dfn>
       <td><code class="idl"><a data-link-type="idl" href="#eventdef-lp2pconnection-datachannel" id="ref-for-eventdef-lp2pconnection-datachannel">datachannel</a></code>
    </table>
    <h3 class="heading settled" data-level="9.8" id="data-channel-communication-examples"><span class="secno">9.8. </span><span class="content">Examples</span><a class="self-link" href="#data-channel-communication-examples"></a></h3>
    <p>Example: Receive a <code class="idl"><a data-link-type="idl" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel④">LP2PDataChannel</a></code> on an existing connection as receiver:</p>
<pre class="example highlight" id="example-a23c2eb3"><a class="self-link" href="#example-a23c2eb3"></a><c- a>const</c-> receiver <c- o>=</c-> <c- ow>new</c-> LP2PReceiver<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-receiver"</c-><c- p>,</c->
<c- p>});</c->

receiver<c- p>.</c->onconnection <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
    <c- a>const</c-> conn <c- o>=</c-> e<c- p>.</c->connection<c- p>;</c->
    console<c- p>.</c->log<c- p>(</c-><c- u>"Receiver: Got a connection!"</c-><c- p>);</c->

    conn<c- p>.</c->ondatachannel <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
        <c- a>const</c-> channel <c- o>=</c-> e<c- p>.</c->channel<c- p>;</c->

        channel<c- p>.</c->onmessage <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
            <c- a>const</c-> message <c- o>=</c-> e<c- p>.</c->data<c- p>;</c->
            console<c- p>.</c->log<c- p>(</c-><c- sb>`Receiver: Received message: </c-><c- si>${</c->message<c- si>}</c-><c- sb>`</c-><c- p>);</c->
        <c- p>};</c->

        channel<c- p>.</c->send<c- p>(</c-><c- u>"Good day to you, requester!"</c-><c- p>);</c->
    <c- p>};</c->
<c- p>};</c->

<c- k>await</c-> receiver<c- p>.</c->start<c- p>();</c->
</pre>
    <p>Example: Create a <code class="idl"><a data-link-type="idl" href="#lp2pdatachannel" id="ref-for-lp2pdatachannel⑤">LP2PDataChannel</a></code> on an existing connection as requester:</p>
<pre class="example highlight" id="example-bf8f41ce"><a class="self-link" href="#example-bf8f41ce"></a><c- a>const</c-> request <c- o>=</c-> <c- ow>new</c-> LP2PRequest<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-request"</c-><c- p>,</c->
<c- p>});</c->

<c- a>const</c-> conn <c- o>=</c-> <c- k>await</c-> request<c- p>.</c->start<c- p>();</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"Requester: Got a connection!"</c-><c- p>);</c->

<c- a>const</c-> channel <c- o>=</c-> conn<c- p>.</c->createDataChannel<c- p>(</c-><c- u>"My Channel"</c-><c- p>);</c->

channel<c- p>.</c->onopen <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
    channel<c- p>.</c->onmessage <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
        <c- a>const</c-> message <c- o>=</c-> e<c- p>.</c->data<c- p>;</c->
        console<c- p>.</c->log<c- p>(</c-><c- sb>`Requester: Received message: </c-><c- si>${</c->message<c- si>}</c-><c- sb>`</c-><c- p>);</c->
    <c- p>};</c->

    channel<c- p>.</c->send<c- p>(</c-><c- u>"Good day to you, receiver!"</c-><c- p>);</c->
<c- p>};</c->
</pre>
   </section>
   <section class="algorithm" data-algorithm="LP2PQuicTransport">
    <h2 class="heading settled" data-level="10" id="lp2p-quic-transport"><span class="secno">10. </span><span class="content">The LP2PQuicTransport Interface</span><a class="self-link" href="#lp2p-quic-transport"></a></h2>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pquictransport"><code>LP2PQuicTransport</code></dfn> Interface allows opening a <a data-link-type="biblio" href="#biblio-webtransport" title="WebTransport">[webtransport]</a> between peers. If the LP2PRequest or LP2PReceiver is not yet started, it must be started when the LP2PQuicTransport is constructed.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①①"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransport" id="ref-for-lp2pquictransport④"><c- g>LP2PQuicTransport</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webtransport/#webtransport" id="ref-for-webtransport"><c- n>WebTransport</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport" data-dfn-type="constructor" data-export data-lt="LP2PQuicTransport(source, quicTransportDict)|constructor(source, quicTransportDict)|LP2PQuicTransport(source)|constructor(source)" id="dom-lp2pquictransport-lp2pquictransport-source-quictransportdict"><code><c- g>constructor</c-></code></dfn>((<a data-link-type="idl-name" href="#lp2prequest" id="ref-for-lp2prequest①"><c- n>LP2PRequest</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#lp2preceiver" id="ref-for-lp2preceiver②"><c- n>LP2PReceiver</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport/LP2PQuicTransport(source, quicTransportDict), LP2PQuicTransport/constructor(source, quicTransportDict), LP2PQuicTransport/LP2PQuicTransport(source), LP2PQuicTransport/constructor(source)" data-dfn-type="argument" data-export id="dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-source"><code><c- g>source</c-></code></dfn>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportinit" id="ref-for-dictdef-lp2pquictransportinit①"><c- n>LP2PQuicTransportInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransport/LP2PQuicTransport(source, quicTransportDict), LP2PQuicTransport/constructor(source, quicTransportDict), LP2PQuicTransport/LP2PQuicTransport(source), LP2PQuicTransport/constructor(source)" data-dfn-type="argument" data-export id="dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-quictransportdict"><code><c- g>quicTransportDict</c-></code></dfn> = {});
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①②"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2pquictransportinit"><code><c- g>LP2PQuicTransportInit</c-></code></dfn> {
};
</pre>
    <p class="issue" id="issue-7594e909"><a class="self-link" href="#issue-7594e909"></a> Define LP2PQuicTransportInit as needed using WebTransportOptions as reference.</p>
    <h3 class="heading settled" data-level="10.1" id="lp2p-quic-transport-listener"><span class="secno">10.1. </span><span class="content">LP2PQuicTransportListener Interface</span><a class="self-link" href="#lp2p-quic-transport-listener"></a></h3>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="lp2pquictransportlistener"><code>LP2PQuicTransportListener</code></dfn> Interface allows listening for incoming <a data-link-type="biblio" href="#biblio-webtransport" title="WebTransport">[webtransport]</a> transports. If the LP2PRequest or LP2PReceiver is not yet started, it must be started when the LP2PQuicTransport is constructed.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①③"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①③"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransportlistener" id="ref-for-lp2pquictransportlistener"><c- g>LP2PQuicTransportListener</c-></a> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransportListener" data-dfn-type="constructor" data-export data-lt="LP2PQuicTransportListener(source, quicTransportListenerDict)|constructor(source, quicTransportListenerDict)|LP2PQuicTransportListener(source)|constructor(source)" id="dom-lp2pquictransportlistener-lp2pquictransportlistener"><code><c- g>constructor</c-></code></dfn>((<a data-link-type="idl-name" href="#lp2prequest" id="ref-for-lp2prequest②"><c- n>LP2PRequest</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#lp2preceiver" id="ref-for-lp2preceiver③"><c- n>LP2PReceiver</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransportListener/LP2PQuicTransportListener(source, quicTransportListenerDict), LP2PQuicTransportListener/constructor(source, quicTransportListenerDict), LP2PQuicTransportListener/LP2PQuicTransportListener(source), LP2PQuicTransportListener/constructor(source)" data-dfn-type="argument" data-export id="dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-source"><code><c- g>source</c-></code></dfn>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportlistenerinit" id="ref-for-dictdef-lp2pquictransportlistenerinit"><c- n>LP2PQuicTransportListenerInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransportListener/LP2PQuicTransportListener(source, quicTransportListenerDict), LP2PQuicTransportListener/constructor(source, quicTransportListenerDict), LP2PQuicTransportListener/LP2PQuicTransportListener(source), LP2PQuicTransportListener/constructor(source)" data-dfn-type="argument" data-export id="dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-quictransportlistenerdict"><code><c- g>quicTransportListenerDict</c-></code></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined③"><c- b>undefined</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransportListener" data-dfn-type="attribute" data-export data-readonly data-type="Promise<undefined>" id="dom-lp2pquictransportlistener-ready"><code><c- g>ready</c-></code></dfn>;
  /* a ReadableStream of LP2PQuicTransport objects */
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream"><c- n>ReadableStream</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="LP2PQuicTransportListener" data-dfn-type="attribute" data-export data-readonly data-type="ReadableStream" id="dom-lp2pquictransportlistener-incomingtransports"><code><c- g>incomingTransports</c-></code></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①④"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①④"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-lp2pquictransportlistenerinit"><code><c- g>LP2PQuicTransportListenerInit</c-></code></dfn> {
};
</pre>
    <p class="issue" id="issue-ebaed6cc"><a class="self-link" href="#issue-ebaed6cc"></a> Define LP2PQuicTransportListenerInit as needed using WebTransportOptions as reference.</p>
    <h3 class="heading settled" data-level="10.2" id="lp2p-quic-transport-examples"><span class="secno">10.2. </span><span class="content">Examples</span><a class="self-link" href="#lp2p-quic-transport-examples"></a></h3>
    <p>Example: Setting up a request for a LP2PQuicTransport:</p>
<pre class="example highlight" id="example-e1be299c"><a class="self-link" href="#example-e1be299c"></a><c- a>const</c-> request <c- o>=</c-> <c- ow>new</c-> LP2PRequest<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-request"</c-><c- p>,</c->
<c- p>});</c->

<c- a>const</c-> transport <c- o>=</c-> <c- ow>new</c-> LP2PQuicTransport<c- p>(</c->request<c- p>);</c->

<c- c1>// Blocks until transport is ready.</c->
<c- k>await</c-> transport<c- p>.</c->ready<c- p>;</c->
</pre>
    <p>Example: Receiving a LP2PQuicTransport:</p>
<pre class="example highlight" id="example-ec08c223"><a class="self-link" href="#example-ec08c223"></a><c- a>const</c-> receiver <c- o>=</c-> <c- ow>new</c-> LP2PReceiver<c- p>({</c->
    nickname<c- o>:</c-> <c- u>"example-receiver"</c-><c- p>,</c->
<c- p>});</c->

<c- a>const</c-> listener <c- o>=</c-> <c- ow>new</c-> LP2PQuicTransportListener<c- p>(</c->receiver<c- p>);</c->

<c- k>for</c-> <c- k>await</c-> <c- p>(</c-><c- a>const</c-> transport <c- k>of</c-> listener<c- p>.</c->incomingTransports<c- p>)</c-> <c- p>{</c->
  <c- c1>// Blocks until transport is ready.</c->
  <c- k>await</c-> transport<c- p>.</c->ready<c- p>;</c->
<c- p>}</c->
</pre>
    <p>Refer to the <a href="https://www.w3.org/TR/webtransport/#examples">WebTransport examples</a> for usage of a <a data-link-type="biblio" href="#biblio-webtransport" title="WebTransport">[webtransport]</a> object.</p>
   </section>
   <h2 class="heading settled" data-level="11" id="security-and-privacy-considerations"><span class="secno">11. </span><span class="content">Security and privacy considerations</span><a class="self-link" href="#security-and-privacy-considerations"></a></h2>
   <h3 class="heading settled" data-level="11.1" id="security-osp"><span class="secno">11.1. </span><span class="content">Open Screen Protocol</span><a class="self-link" href="#security-osp"></a></h3>
    The Local Peer-to-Peer API is meant to be implementable on the <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a>. The Security and Privacy considerations of the Open Screen Protocol must therefore be considered when implementing this API. 
   <h3 class="heading settled" data-level="11.2" id="security-pii"><span class="secno">11.2. </span><span class="content">Personally identifiable information</span><a class="self-link" href="#security-pii"></a></h3>
    The peer attributes, such as the nickname and device model, are provided to give minimal context to a connected peer. This information could be used in conjunction with other information for fingerprinting the user. However, this information is only available to an origin after it has been authenticated and a user has given explicit consent to make the connection to the remote peer. 
   <p>No information is exposed to the origin during service discovery. No IP information is exposed to an origin. This is fully managed by the user agent.</p>
   <p class="issue" id="issue-804ebe7f"><a class="self-link" href="#issue-804ebe7f"></a> Refine peer attributes, related: <a href="https://github.com/WICG/local-peer-to-peer/issues/15">[Issue #WICG/local-peer-to-peer#15]</a></p>
   <h3 class="heading settled" data-level="11.3" id="security-ui"><span class="secno">11.3. </span><span class="content">User interface guidelines</span><a class="self-link" href="#security-ui"></a></h3>
   <p>When the user is asked to grant permission to connect to a peer, the user agent should make it clear what origin the request is coming from.</p>
   <p class="issue" id="issue-2d8fb87e"><a class="self-link" href="#issue-2d8fb87e"></a> Define filtering to provide additional context, related: <a href="https://github.com/WICG/local-peer-to-peer/issues/15">[Issue #WICG/local-peer-to-peer#15]</a></p>
   <h3 class="heading settled" data-level="11.4" id="security-same-origin"><span class="secno">11.4. </span><span class="content">Impact on same-origin policy</span><a class="self-link" href="#security-same-origin"></a></h3>
   <p>This document extends the Web platform with the ability to set up real-time, direct communication between browsers and other devices, including other browsers, within the local area network.</p>
   <p>This means that data and media can be shared between applications running in different browsers, or between an application running in the browser and another user agent that is not a browser such as a headless service provided by a smart TV or smart fridge. This extends the usual barriers in the Web’s security model that prevents sending data between entities with different origins.</p>
   <h3 class="heading settled" data-level="11.5" id="security-device-access"><span class="secno">11.5. </span><span class="content">Device Access</span><a class="self-link" href="#security-device-access"></a></h3>
   <p>The Local Peer-to-Peer API requires user permission for a page to access any peers. The API uses purpose-fit protocols for data communication. It cannot be used to connect to raw sockets or unknowing HTTP servers. In addition, a user must <a data-link-type="dfn" href="#acquire-a-local-peer-grant" id="ref-for-acquire-a-local-peer-grant③">acquire a local peer grant</a> by explicitly providing consenting for an origin to connect to a peer. In addition, a user must <a data-link-type="dfn" href="#authenticate-a-local-peer" id="ref-for-authenticate-a-local-peer①">authenticate a local peer</a> before use.</p>
   <h3 class="heading settled" data-level="11.6" id="security-persistent-state"><span class="secno">11.6. </span><span class="content">Persistent State</span><a class="self-link" href="#security-persistent-state"></a></h3>
    The persisted state considerations of the <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a> must be followed when implementing this API. 
   <h3 class="heading settled" data-level="11.7" id="security-secure-context"><span class="secno">11.7. </span><span class="content">Secure Contexts</span><a class="self-link" href="#security-secure-context"></a></h3>
    The Local Peer-to-Peer API must only be provided in a secure context. 
   <h2 class="heading settled" id="appendix-a"><span class="content">Appendix A: OSP Extension Messages</span><a class="self-link" href="#appendix-a"></a></h2>
   <p>The following messages are defined according to and as an extension to the <a data-link-type="biblio" href="#biblio-openscreenprotocol" title="Open Screen Protocol">Open Screen Protocol</a> <a href="https://www.w3.org/TR/openscreenprotocol/#appendix-a">Messages</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The type keys and capability IDs for these extensions are not officially registered yet. They will be registered as this specification matures.</p>
<pre class="data highlight"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="agent-capability"><c- nc>agent-capability</c-></dfn> <c- o>=</c-> <c- o>&amp;</c-><c- p>(</c->
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="data-channels"><c- s>data-channels</c-></dfn><c- p>:</c-> <c- mi>11</c-><c- nc>OO</c->
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="quick-transport"><c- s>quick-transport</c-></dfn><c- p>:</c-> <c- mi>12</c-><c- nc>OO</c->
<c- p>)</c->

<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="data-channel-encoding-id"><c- nc>data-channel-encoding-id</c-></dfn> <c- o>=</c-> <c- o>&amp;</c-><c- p>(</c->
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="encoding-id-blob"><c- s>encoding-id-blob</c-></dfn><c- p>:</c-> <c- mi>0</c->
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="encoding-id-string"><c- s>encoding-id-string</c-></dfn><c- p>:</c-> <c- mi>1</c->
  <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="encoding-id-array-buffer"><c- s>encoding-id-array-buffer</c-></dfn><c- p>:</c-> <c- mi>2</c->
<c- p>)</c->

<c- c1>; type key 24</c->
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="data-frame"><c- nc>data-frame</c-></dfn> <c- o>=</c-> <c- p>{</c->
  <c- mi>0</c-><c- p>:</c-> <c- nc>data-channel-encoding-id</c-> <c- c1>; encoding-id</c->
  <c- mi>4</c-><c- p>:</c-> bytes <c- c1>; payload</c->
<c- p>}</c->

<c- c1>; type key 1101</c->
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="data-channel-open-request"><c- nc>data-channel-open-request</c-></dfn> <c- o>=</c-> <c- p>{</c->
  <c- nc>request</c->
  <c- mi>1</c-><c- p>:</c-> uint <c- c1>; channel-id</c->
  <c- mi>2</c-><c- p>:</c-> text <c- c1>; label</c->
  <c- mi>3</c-><c- p>:</c-> text <c- c1>; protocol</c->
<c- p>}</c->

<c- c1>; type key 1102</c->
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="data-channel-open-response"><c- nc>data-channel-open-response</c-></dfn> <c- o>=</c-> <c- p>{</c->
  <c- nc>response</c->
  <c- mi>1</c-><c- p>:</c-> <c- o>&amp;</c-><c- nc>result</c-> <c- c1>; result</c->
<c- p>}</c->
</pre>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#acquire-a-local-peer-grant">acquire a local peer grant</a><span>, in § 3.5</span>
   <li><a href="#session-advertise-agent">advertise agent</a><span>, in § 4</span>
   <li><a href="#agent-capability">agent-capability</a><span>, in § Unnumbered section</span>
   <li><a href="#authenticate-a-local-peer">authenticate a local peer</a><span>, in § 3.4</span>
   <li><a href="#session-authenticate-an-agent">authenticate an agent</a><span>, in § 4</span>
   <li><a href="#authenticated">authenticated</a><span>, in § 3.4</span>
   <li><a href="#authentication-state">authentication state</a><span>, in § 3.1</span>
   <li><a href="#dom-lp2pdatachannel-binarytype">binaryType</a><span>, in § 9</span>
   <li>
    channel
    <ul>
     <li><a href="#dom-lp2pdatachannelevent-channel">attribute for LP2PDataChannelEvent</a><span>, in § 9.5</span>
     <li><a href="#dom-lp2pdatachanneleventinit-channel">dict-member for LP2PDataChannelEventInit</a><span>, in § 9.5</span>
    </ul>
   <li><a href="#eventdef-lp2pdatachannel-close">close</a><span>, in § 9.2</span>
   <li><a href="#dom-lp2pdatachannel-close">close()</a><span>, in § 9</span>
   <li><a href="#eventdef-lp2pdatachannel-closing">closing</a><span>, in § 9.2</span>
   <li>
    connection
    <ul>
     <li><a href="#dom-lp2pconnectionevent-connection">attribute for LP2PConnectionEvent</a><span>, in § 6.2</span>
     <li><a href="#dom-lp2pconnectioneventinit-connection">dict-member for LP2PConnectionEventInit</a><span>, in § 6.2</span>
     <li><a href="#eventdef-lp2preceiver-connection">event for LP2PReceiver</a><span>, in § 6.3</span>
    </ul>
   <li>
    constructor()
    <ul>
     <li><a href="#dom-lp2preceiver-lp2preceiver">constructor for LP2PReceiver</a><span>, in § 6</span>
     <li><a href="#dom-lp2prequest-lp2prequest">constructor for LP2PRequest</a><span>, in § 7</span>
    </ul>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport">constructor(connection)</a><span>, in § 8.1</span>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport">constructor(connection, quicTransportDict)</a><span>, in § 8.1</span>
   <li><a href="#dom-lp2pdatachannel-lp2pdatachannel">constructor(label)</a><span>, in § 9</span>
   <li><a href="#dom-lp2pdatachannel-lp2pdatachannel">constructor(label, dataChannelDict)</a><span>, in § 9</span>
   <li>
    constructor(options)
    <ul>
     <li><a href="#dom-lp2preceiver-lp2preceiver">constructor for LP2PReceiver</a><span>, in § 6</span>
     <li><a href="#dom-lp2prequest-lp2prequest">constructor for LP2PRequest</a><span>, in § 7</span>
    </ul>
   <li>
    constructor(source)
    <ul>
     <li><a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict">constructor for LP2PQuicTransport</a><span>, in § 10</span>
     <li><a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener">constructor for LP2PQuicTransportListener</a><span>, in § 10.1</span>
    </ul>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict">constructor(source, quicTransportDict)</a><span>, in § 10</span>
   <li><a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener">constructor(source, quicTransportListenerDict)</a><span>, in § 10.1</span>
   <li><a href="#dom-lp2pconnectionevent-lp2pconnectionevent">constructor(type, connectionEventInitDict)</a><span>, in § 6.2</span>
   <li><a href="#dom-lp2pdatachannelevent-lp2pdatachannelevent">constructor(type, DataChannelEventInitDict)</a><span>, in § 9.5</span>
   <li><a href="#dom-lp2pconnection-createdatachannel">createDataChannel(label)</a><span>, in § 9.4</span>
   <li><a href="#dom-lp2pconnection-createdatachannel">createDataChannel(label, dataChannelDict)</a><span>, in § 9.4</span>
   <li><a href="#eventdef-lp2pconnection-datachannel">datachannel</a><span>, in § 9.6</span>
   <li><a href="#data-channel-encoding-id">data-channel-encoding-id</a><span>, in § Unnumbered section</span>
   <li><a href="#data-channel-open-request">data-channel-open-request</a><span>, in § Unnumbered section</span>
   <li><a href="#data-channel-open-response">data-channel-open-response</a><span>, in § Unnumbered section</span>
   <li><a href="#data-channels">data-channels</a><span>, in § Unnumbered section</span>
   <li><a href="#data-frame">data-frame</a><span>, in § Unnumbered section</span>
   <li><a href="#session-discover-agents">discover agents</a><span>, in § 4</span>
   <li><a href="#session-discover-metadata">discover metadata</a><span>, in § 4</span>
   <li><a href="#encoding-id-array-buffer">encoding-id-array-buffer</a><span>, in § Unnumbered section</span>
   <li><a href="#encoding-id-blob">encoding-id-blob</a><span>, in § Unnumbered section</span>
   <li><a href="#encoding-id-string">encoding-id-string</a><span>, in § Unnumbered section</span>
   <li><a href="#eventdef-lp2pdatachannel-error">error</a><span>, in § 9.2</span>
   <li><a href="#establish-local-peer-connection">establish local peer connection</a><span>, in § 4</span>
   <li>
    id
    <ul>
     <li><a href="#dom-lp2pdatachannel-id">attribute for LP2PDataChannel</a><span>, in § 9</span>
     <li><a href="#dom-lp2pdatachannelinit-id">dict-member for LP2PDataChannelInit</a><span>, in § 9.1</span>
    </ul>
   <li><a href="#dom-lp2pquictransportlistener-incomingtransports">incomingTransports</a><span>, in § 10.1</span>
   <li><a href="#known-peer">known peer</a><span>, in § 3.1</span>
   <li><a href="#known-peers-map">known peers map</a><span>, in § 3.1</span>
   <li><a href="#dom-lp2pdatachannel-label">label</a><span>, in § 9</span>
   <li><a href="#local-peer-to-peer-manager">local peer-to-peer manager</a><span>, in § 3</span>
   <li><a href="#protocol-local-peer-to-peer-session">Local Peer-to-Peer session</a><span>, in § 4</span>
   <li><a href="#lp2pconnection">LP2PConnection</a><span>, in § 8</span>
   <li><a href="#lp2pconnectionevent">LP2PConnectionEvent</a><span>, in § 6.2</span>
   <li><a href="#dictdef-lp2pconnectioneventinit">LP2PConnectionEventInit</a><span>, in § 6.2</span>
   <li><a href="#dom-lp2pconnectionevent-lp2pconnectionevent">LP2PConnectionEvent(type, connectionEventInitDict)</a><span>, in § 6.2</span>
   <li><a href="#lp2pdatachannel">LP2PDataChannel</a><span>, in § 9</span>
   <li><a href="#lp2pdatachannelevent">LP2PDataChannelEvent</a><span>, in § 9.5</span>
   <li><a href="#dictdef-lp2pdatachanneleventinit">LP2PDataChannelEventInit</a><span>, in § 9.5</span>
   <li><a href="#dom-lp2pdatachannelevent-lp2pdatachannelevent">LP2PDataChannelEvent(type, DataChannelEventInitDict)</a><span>, in § 9.5</span>
   <li><a href="#dictdef-lp2pdatachannelinit">LP2PDataChannelInit</a><span>, in § 9.1</span>
   <li><a href="#dom-lp2pdatachannel-lp2pdatachannel">LP2PDataChannel(label)</a><span>, in § 9</span>
   <li><a href="#dom-lp2pdatachannel-lp2pdatachannel">LP2PDataChannel(label, dataChannelDict)</a><span>, in § 9</span>
   <li><a href="#lp2pquictransport">LP2PQuicTransport</a><span>, in § 10</span>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport">LP2PQuicTransport(connection)</a><span>, in § 8.1</span>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport">LP2PQuicTransport(connection, quicTransportDict)</a><span>, in § 8.1</span>
   <li><a href="#dictdef-lp2pquictransportinit">LP2PQuicTransportInit</a><span>, in § 10</span>
   <li><a href="#lp2pquictransportlistener">LP2PQuicTransportListener</a><span>, in § 10.1</span>
   <li><a href="#dictdef-lp2pquictransportlistenerinit">LP2PQuicTransportListenerInit</a><span>, in § 10.1</span>
   <li><a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener">LP2PQuicTransportListener(source)</a><span>, in § 10.1</span>
   <li><a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener">LP2PQuicTransportListener(source, quicTransportListenerDict)</a><span>, in § 10.1</span>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict">LP2PQuicTransport(source)</a><span>, in § 10</span>
   <li><a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict">LP2PQuicTransport(source, quicTransportDict)</a><span>, in § 10</span>
   <li><a href="#lp2preceiver">LP2PReceiver</a><span>, in § 6</span>
   <li><a href="#dom-lp2preceiver-lp2preceiver">LP2PReceiver()</a><span>, in § 6</span>
   <li><a href="#dom-lp2preceiver-lp2preceiver">LP2PReceiver(options)</a><span>, in § 6</span>
   <li><a href="#dictdef-lp2preceiveroptions">LP2PReceiverOptions</a><span>, in § 6.1</span>
   <li><a href="#lp2prequest">LP2PRequest</a><span>, in § 7</span>
   <li><a href="#dom-lp2prequest-lp2prequest">LP2PRequest()</a><span>, in § 7</span>
   <li><a href="#dom-lp2prequest-lp2prequest">LP2PRequest(options)</a><span>, in § 7</span>
   <li><a href="#dictdef-lp2prequestoptions">LP2PRequestOptions</a><span>, in § 7.1</span>
   <li><a href="#eventdef-lp2pdatachannel-message">message</a><span>, in § 9.2</span>
   <li>
    nickname
    <ul>
     <li><a href="#dom-lp2preceiveroptions-nickname">dict-member for LP2PReceiverOptions</a><span>, in § 6.1</span>
     <li><a href="#dom-lp2prequestoptions-nickname">dict-member for LP2PRequestOptions</a><span>, in § 7.1</span>
    </ul>
   <li><a href="#dom-lp2pdatachannel-onclose">onclose</a><span>, in § 9.3</span>
   <li><a href="#dom-lp2pdatachannel-onclosing">onclosing</a><span>, in § 9.3</span>
   <li><a href="#dom-lp2preceiver-onconnection">onconnection</a><span>, in § 6.4</span>
   <li><a href="#dom-lp2pconnection-ondatachannel">ondatachannel</a><span>, in § 9.7</span>
   <li><a href="#dom-lp2pdatachannel-onerror">onerror</a><span>, in § 9.3</span>
   <li><a href="#dom-lp2pdatachannel-onmessage">onmessage</a><span>, in § 9.3</span>
   <li><a href="#dom-lp2pdatachannel-onopen">onopen</a><span>, in § 9.3</span>
   <li><a href="#eventdef-lp2pdatachannel-open">open</a><span>, in § 9.2</span>
   <li><a href="#open-a-data-channel">open a data channel</a><span>, in § 4.1</span>
   <li><a href="#open-a-webtransport-session">open a WebTransport session</a><span>, in § 4.2</span>
   <li><a href="#peer">peer</a><span>, in § 3</span>
   <li><a href="#peer-grant-state">peer grant state</a><span>, in § 3.1</span>
   <li><a href="#persisted">persisted</a><span>, in § 3.1</span>
   <li>
    protocol
    <ul>
     <li><a href="#dom-lp2pdatachannel-protocol">attribute for LP2PDataChannel</a><span>, in § 9</span>
     <li><a href="#dom-lp2pdatachannelinit-protocol">dict-member for LP2PDataChannelInit</a><span>, in § 9.1</span>
    </ul>
   <li><a href="#quick-transport">quick-transport</a><span>, in § Unnumbered section</span>
   <li><a href="#dom-lp2pquictransportlistener-ready">ready</a><span>, in § 10.1</span>
   <li><a href="#dom-lp2pdatachannel-send">send(data)</a><span>, in § 9</span>
   <li><a href="#send-data-on-a-channel">send data on a channel</a><span>, in § 4.1</span>
   <li>
    start()
    <ul>
     <li><a href="#dom-lp2preceiver-start">method for LP2PReceiver</a><span>, in § 6</span>
     <li><a href="#dom-lp2prequest-start">method for LP2PRequest</a><span>, in § 7</span>
    </ul>
   <li><a href="#start-local-peer-discovery">start local peer discovery</a><span>, in § 3.3</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="129bdae8">Event</span>
     <li><span class="dfn-paneled" id="44a7708c">EventInit</span>
     <li><span class="dfn-paneled" id="2bc0cdf4">EventTarget</span>
     <li><span class="dfn-paneled" id="5fd23811">fire an event</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FileAPI]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b7d73f5b">Blob</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f0951476">EventHandler</span>
     <li><span class="dfn-paneled" id="3e8c0e5f">MessageEvent</span>
     <li><span class="dfn-paneled" id="3610bd67">allowed to use</span>
     <li><span class="dfn-paneled" id="6a5a59a0">event handler</span>
     <li><span class="dfn-paneled" id="9d386f55">event handler event type</span>
     <li><span class="dfn-paneled" id="03675365">event handler idl attribute</span>
     <li><span class="dfn-paneled" id="7393da89">same origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="84b454ff">ordered map</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERMISSIONS-POLICY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="1570624a">default allowlist</span>
     <li><span class="dfn-paneled" id="cc890cc1">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="59ed4e57">ReadableStream</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2f8afbfe">ArrayBuffer</span>
     <li><span class="dfn-paneled" id="6c9ab516">ArrayBufferView</span>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
     <li><span class="dfn-paneled" id="c01cbda0">EnforceRange</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="bdbd19d1">Promise</span>
     <li><span class="dfn-paneled" id="b75bb3bd">SecureContext</span>
     <li><span class="dfn-paneled" id="b0d7f3c3">USVString</span>
     <li><span class="dfn-paneled" id="5f90bbfb">undefined</span>
     <li><span class="dfn-paneled" id="450958f7">unsigned short</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBSOCKETS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="88d6f55f">BinaryType</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBTRANSPORT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85122cbe">WebTransport</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fileapi">[FileAPI]
   <dd>Marijn Kruisselbrink. <a href="https://w3c.github.io/FileAPI/"><cite>File API</cite></a>. URL: <a href="https://w3c.github.io/FileAPI/">https://w3c.github.io/FileAPI/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-openscreenprotocol">[OPENSCREENPROTOCOL]
   <dd>Mark Foltz. <a href="https://w3c.github.io/openscreenprotocol/"><cite>Open Screen Protocol</cite></a>. URL: <a href="https://w3c.github.io/openscreenprotocol/">https://w3c.github.io/openscreenprotocol/</a>
   <dt id="biblio-permissions-policy">[PERMISSIONS-POLICY]
   <dd>Ian Clelland. <a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions Policy</cite></a>. URL: <a href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc9000">[RFC9000]
   <dd>J. Iyengar, Ed.; M. Thomson, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc9000"><cite>QUIC: A UDP-Based Multiplexed and Secure Transport</cite></a>. May 2021. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>
   <dt id="biblio-streams">[STREAMS]
   <dd>Adam Rice; et al. <a href="https://streams.spec.whatwg.org/"><cite>Streams Standard</cite></a>. Living Standard. URL: <a href="https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-webrtc">[WEBRTC]
   <dd>Cullen Jennings; et al. <a href="https://w3c.github.io/webrtc-pc/"><cite>WebRTC: Real-Time Communication in Browsers</cite></a>. URL: <a href="https://w3c.github.io/webrtc-pc/">https://w3c.github.io/webrtc-pc/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Adam Rice. <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets Standard</cite></a>. Living Standard. URL: <a href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
   <dt id="biblio-webtransport">[WEBTRANSPORT]
   <dd>Bernard Aboba; Nidhi Jaju; Victor Vasiliev. <a href="https://w3c.github.io/webtransport/"><cite>WebTransport</cite></a>. URL: <a href="https://w3c.github.io/webtransport/">https://w3c.github.io/webtransport/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2preceiver"><c- g>LP2PReceiver</c-></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <a href="#dom-lp2preceiver-lp2preceiver"><code><c- g>constructor</c-></code></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2preceiveroptions"><c- n>LP2PReceiverOptions</c-></a> <a href="#dom-lp2preceiver-lp2preceiver-options-options"><code><c- g>options</c-></code></a> = {});
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2preceiver-onconnection"><c- g>onconnection</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a href="#dom-lp2preceiver-start"><code><c- g>start</c-></code></a>();
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <a href="#dictdef-lp2preceiveroptions"><code><c- g>LP2PReceiverOptions</c-></code></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-lp2preceiveroptions-nickname"><code><c- g>nickname</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a href="#lp2pconnectionevent"><code><c- g>LP2PConnectionEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
    <a href="#dom-lp2pconnectionevent-lp2pconnectionevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-type"><code><c- g>type</c-></code></a>, <a data-link-type="idl-name" href="#dictdef-lp2pconnectioneventinit"><c- n>LP2PConnectionEventInit</c-></a> <a href="#dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-connectioneventinitdict"><code><c- g>connectionEventInitDict</c-></code></a>);
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#lp2pconnection"><c- n>LP2PConnection</c-></a> <a data-readonly data-type="LP2PConnection" href="#dom-lp2pconnectionevent-connection"><code><c- g>connection</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-lp2pconnectioneventinit"><code><c- g>LP2PConnectionEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a data-link-type="idl-name" href="#lp2pconnection"><c- n>LP2PConnection</c-></a> <a data-type="LP2PConnection " href="#dom-lp2pconnectioneventinit-connection"><code><c- g>connection</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2prequest"><c- g>LP2PRequest</c-></a> {
    <a href="#dom-lp2prequest-lp2prequest"><code><c- g>constructor</c-></code></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2prequestoptions"><c- n>LP2PRequestOptions</c-></a> <a href="#dom-lp2prequest-lp2prequest-options-options"><code><c- g>options</c-></code></a> = {});
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#lp2pconnection"><c- n>LP2PConnection</c-></a>> <a href="#dom-lp2prequest-start"><code><c- g>start</c-></code></a>();
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <a href="#dictdef-lp2prequestoptions"><code><c- g>LP2PRequestOptions</c-></code></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-lp2prequestoptions-nickname"><code><c- g>nickname</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pconnection"><c- g>LP2PConnection</c-></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransport"><c- g>LP2PQuicTransport</c-></a> {
  <a href="#dom-lp2pquictransport-lp2pquictransport"><code><c- g>constructor</c-></code></a>(<a data-link-type="idl-name" href="#lp2pconnection"><c- n>LP2PConnection</c-></a> <a href="#dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-connection"><code><c- g>connection</c-></code></a>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportinit"><c- n>LP2PQuicTransportInit</c-></a> <a href="#dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-quictransportdict"><code><c- g>quicTransportDict</c-></code></a> = {});
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a href="#lp2pdatachannel"><code><c- g>LP2PDataChannel</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <a href="#dom-lp2pdatachannel-lp2pdatachannel"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-label"><code><c- g>label</c-></code></a>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pdatachannelinit"><c- n>LP2PDataChannelInit</c-></a> <a href="#dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-datachanneldict"><code><c- g>dataChannelDict</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-lp2pdatachannel-label"><code><c- g>label</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-lp2pdatachannel-protocol"><code><c- g>protocol</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a>? <a data-readonly data-type="unsigned short?" href="#dom-lp2pdatachannel-id"><code><c- g>id</c-></code></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onopen"><c- g>onopen</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onerror"><c- g>onerror</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onclosing"><c- g>onclosing</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onclose"><c- g>onclose</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a href="#dom-lp2pdatachannel-close"><code><c- g>close</c-></code></a>();
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pdatachannel-onmessage"><c- g>onmessage</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://websockets.spec.whatwg.org/#enumdef-binarytype"><c- n>BinaryType</c-></a> <a data-type="BinaryType" href="#dom-lp2pdatachannel-binarytype"><code><c- g>binaryType</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a> <a href="#dom-lp2pdatachannel-send"><code><c- g>send</c-></code></a>((<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://w3c.github.io/FileAPI/#dfn-Blob"><c- n>Blob</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><c- b>ArrayBuffer</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#ArrayBufferView"><c- n>ArrayBufferView</c-></a>) <a href="#dom-lp2pdatachannel-send-data-data"><code><c- g>data</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <a href="#dictdef-lp2pdatachannelinit"><code><c- g>LP2PDataChannelInit</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-default="&quot;&quot;" data-type="USVString " href="#dom-lp2pdatachannelinit-protocol"><code><c- g>protocol</c-></code></a> = "";
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-type="unsigned short " href="#dom-lp2pdatachannelinit-id"><code><c- g>id</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pconnection"><c- g>LP2PConnection</c-></a> {
  <a data-link-type="idl-name" href="#lp2pdatachannel"><c- n>LP2PDataChannel</c-></a> <a href="#dom-lp2pconnection-createdatachannel"><code><c- g>createDataChannel</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a href="#dom-lp2pconnection-createdatachannel-label-datachanneldict-label"><code><c- g>label</c-></code></a>,
                                    <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pdatachannelinit"><c- n>LP2PDataChannelInit</c-></a> <a href="#dom-lp2pconnection-createdatachannel-label-datachanneldict-datachanneldict"><code><c- g>dataChannelDict</c-></code></a> = {});
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-lp2pconnection-ondatachannel"><c- g>ondatachannel</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a href="#lp2pdatachannelevent"><code><c- g>LP2PDataChannelEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
  <a href="#dom-lp2pdatachannelevent-lp2pdatachannelevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-type"><code><c- g>type</c-></code></a>, <a data-link-type="idl-name" href="#dictdef-lp2pdatachanneleventinit"><c- n>LP2PDataChannelEventInit</c-></a> <a href="#dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-datachanneleventinitdict"><code><c- g>DataChannelEventInitDict</c-></code></a>);
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#lp2pdatachannel"><c- n>LP2PDataChannel</c-></a> <a data-readonly data-type="LP2PDataChannel" href="#dom-lp2pdatachannelevent-channel"><code><c- g>channel</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-lp2pdatachanneleventinit"><code><c- g>LP2PDataChannelEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a data-link-type="idl-name" href="#lp2pdatachannel"><c- n>LP2PDataChannel</c-></a> <a data-type="LP2PDataChannel " href="#dom-lp2pdatachanneleventinit-channel"><code><c- g>channel</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransport"><c- g>LP2PQuicTransport</c-></a> : <a data-link-type="idl-name" href="https://w3c.github.io/webtransport/#webtransport"><c- n>WebTransport</c-></a> {
  <a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict"><code><c- g>constructor</c-></code></a>((<a data-link-type="idl-name" href="#lp2prequest"><c- n>LP2PRequest</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#lp2preceiver"><c- n>LP2PReceiver</c-></a>) <a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-source"><code><c- g>source</c-></code></a>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportinit"><c- n>LP2PQuicTransportInit</c-></a> <a href="#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-quictransportdict"><code><c- g>quicTransportDict</c-></code></a> = {});
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <a href="#dictdef-lp2pquictransportinit"><code><c- g>LP2PQuicTransportInit</c-></code></a> {
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="#lp2pquictransportlistener"><c- g>LP2PQuicTransportListener</c-></a> {
  <a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener"><code><c- g>constructor</c-></code></a>((<a data-link-type="idl-name" href="#lp2prequest"><c- n>LP2PRequest</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#lp2preceiver"><c- n>LP2PReceiver</c-></a>) <a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-source"><code><c- g>source</c-></code></a>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-lp2pquictransportlistenerinit"><c- n>LP2PQuicTransportListenerInit</c-></a> <a href="#dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-quictransportlistenerdict"><code><c- g>quicTransportListenerDict</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a data-readonly data-type="Promise<undefined>" href="#dom-lp2pquictransportlistener-ready"><code><c- g>ready</c-></code></a>;
  /* a ReadableStream of LP2PQuicTransport objects */
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream"><c- n>ReadableStream</c-></a> <a data-readonly data-type="ReadableStream" href="#dom-lp2pquictransportlistener-incomingtransports"><code><c- g>incomingTransports</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>]
<c- b>dictionary</c-> <a href="#dictdef-lp2pquictransportlistenerinit"><code><c- g>LP2PQuicTransportListenerInit</c-></code></a> {
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> See also related <a href="https://github.com/wicg/local-peer-to-peer/issues/24">[Issue #wicg/local-peer-to-peer#24]</a> <a class="issue-return" href="#issue-45136692" title="Jump to section">↵</a></div>
   <div class="issue"> define endpoint-info messages <a class="issue-return" href="#issue-bea8fec9" title="Jump to section">↵</a></div>
   <div class="issue"> In general, when defining a new interface that inherits from Event please always ask feedback from the WHATWG or the W3C WebApps WG community. See <a href="https://dom.spec.whatwg.org/#defining-event-interfaces">defining event interfaces</a>. <a class="issue-return" href="#issue-2e09a0e3" title="Jump to section">↵</a></div>
   <div class="issue"> In general, when defining a new interface that inherits from Event please always ask feedback from the WHATWG or the W3C WebApps WG community. See <a href="https://dom.spec.whatwg.org/#defining-event-interfaces">defining event interfaces</a>. <a class="issue-return" href="#issue-2e09a0e3①" title="Jump to section">↵</a></div>
   <div class="issue"> Define LP2PQuicTransportInit as needed using WebTransportOptions as reference. <a class="issue-return" href="#issue-7594e909" title="Jump to section">↵</a></div>
   <div class="issue"> Define LP2PQuicTransportListenerInit as needed using WebTransportOptions as reference. <a class="issue-return" href="#issue-ebaed6cc" title="Jump to section">↵</a></div>
   <div class="issue"> Refine peer attributes, related: <a href="https://github.com/WICG/local-peer-to-peer/issues/15">[Issue #WICG/local-peer-to-peer#15]</a> <a class="issue-return" href="#issue-804ebe7f" title="Jump to section">↵</a></div>
   <div class="issue"> Define filtering to provide additional context, related: <a href="https://github.com/WICG/local-peer-to-peer/issues/15">[Issue #WICG/local-peer-to-peer#15]</a> <a class="issue-return" href="#issue-2d8fb87e" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"03675365": {"dfnID":"03675365","dfnText":"event handler idl attribute","external":true,"refSections":[{"refs":[{"id":"ref-for-event-handler-idl-attributes"}],"title":"6.4. Event handlers"},{"refs":[{"id":"ref-for-event-handler-idl-attributes\u2460"}],"title":"9.3. Event handlers"},{"refs":[{"id":"ref-for-event-handler-idl-attributes\u2461"}],"title":"9.7. Extensions Event handlers"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"},
"129bdae8": {"dfnID":"129bdae8","dfnText":"Event","external":true,"refSections":[{"refs":[{"id":"ref-for-event"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-event\u2460"},{"id":"ref-for-event\u2461"},{"id":"ref-for-event\u2462"},{"id":"ref-for-event\u2463"}],"title":"9.2. Events"},{"refs":[{"id":"ref-for-event\u2464"}],"title":"9.5. LP2PDataChannelEvent"}],"url":"https://dom.spec.whatwg.org/#event"},
"1570624a": {"dfnID":"1570624a","dfnText":"default allowlist","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-controlled-feature-default-allowlist"},{"id":"ref-for-policy-controlled-feature-default-allowlist\u2460"}],"title":"2. Permission Policy Integration"}],"url":"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist"},
"2bc0cdf4": {"dfnID":"2bc0cdf4","dfnText":"EventTarget","external":true,"refSections":[{"refs":[{"id":"ref-for-eventtarget"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-eventtarget\u2460"}],"title":"8. The LP2PConnection Interface"},{"refs":[{"id":"ref-for-eventtarget\u2461"}],"title":"9. The LP2PDataChannel Interface"}],"url":"https://dom.spec.whatwg.org/#eventtarget"},
"2f8afbfe": {"dfnID":"2f8afbfe","dfnText":"ArrayBuffer","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-ArrayBuffer"}],"title":"9. The LP2PDataChannel Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-ArrayBuffer"},
"3610bd67": {"dfnID":"3610bd67","dfnText":"allowed to use","external":true,"refSections":[{"refs":[{"id":"ref-for-allowed-to-use"}],"title":"2. Permission Policy Integration"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use"},
"3e8c0e5f": {"dfnID":"3e8c0e5f","dfnText":"MessageEvent","external":true,"refSections":[{"refs":[{"id":"ref-for-messageevent"}],"title":"9.2. Events"}],"url":"https://html.spec.whatwg.org/multipage/comms.html#messageevent"},
"44a7708c": {"dfnID":"44a7708c","dfnText":"EventInit","external":true,"refSections":[{"refs":[{"id":"ref-for-dictdef-eventinit"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-dictdef-eventinit\u2460"}],"title":"9.5. LP2PDataChannelEvent"}],"url":"https://dom.spec.whatwg.org/#dictdef-eventinit"},
"450958f7": {"dfnID":"450958f7","dfnText":"unsigned short","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-unsigned-short"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-idl-unsigned-short\u2460"}],"title":"9.1. LP2PDataChannelInit"}],"url":"https://webidl.spec.whatwg.org/#idl-unsigned-short"},
"59ed4e57": {"dfnID":"59ed4e57","dfnText":"ReadableStream","external":true,"refSections":[{"refs":[{"id":"ref-for-readablestream"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"https://streams.spec.whatwg.org/#readablestream"},
"5f90bbfb": {"dfnID":"5f90bbfb","dfnText":"undefined","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-undefined"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-idl-undefined\u2460"},{"id":"ref-for-idl-undefined\u2461"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-idl-undefined\u2462"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"5fd23811": {"dfnID":"5fd23811","dfnText":"fire an event","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-event-fire"}],"title":"6.3. Events"},{"refs":[{"id":"ref-for-concept-event-fire\u2460"}],"title":"9.2. Events"},{"refs":[{"id":"ref-for-concept-event-fire\u2461"}],"title":"9.6. Extensions Events"}],"url":"https://dom.spec.whatwg.org/#concept-event-fire"},
"6a5a59a0": {"dfnID":"6a5a59a0","dfnText":"event handler","external":true,"refSections":[{"refs":[{"id":"ref-for-event-handlers"},{"id":"ref-for-event-handlers\u2460"}],"title":"6.4. Event handlers"},{"refs":[{"id":"ref-for-event-handlers\u2461"},{"id":"ref-for-event-handlers\u2462"}],"title":"9.3. Event handlers"},{"refs":[{"id":"ref-for-event-handlers\u2463"},{"id":"ref-for-event-handlers\u2464"}],"title":"9.7. Extensions Event handlers"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"},
"6c9ab516": {"dfnID":"6c9ab516","dfnText":"ArrayBufferView","external":true,"refSections":[{"refs":[{"id":"ref-for-ArrayBufferView"}],"title":"9. The LP2PDataChannel Interface"}],"url":"https://webidl.spec.whatwg.org/#ArrayBufferView"},
"7393da89": {"dfnID":"7393da89","dfnText":"same origin","external":true,"refSections":[{"refs":[{"id":"ref-for-same-origin"}],"title":"2. Permission Policy Integration"}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"84b454ff": {"dfnID":"84b454ff","dfnText":"ordered map","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-map"}],"title":"3.1. Known peers"}],"url":"https://infra.spec.whatwg.org/#ordered-map"},
"85122cbe": {"dfnID":"85122cbe","dfnText":"WebTransport","external":true,"refSections":[{"refs":[{"id":"ref-for-webtransport"}],"title":"10. The LP2PQuicTransport Interface"}],"url":"https://w3c.github.io/webtransport/#webtransport"},
"8855a9aa": {"dfnID":"8855a9aa","dfnText":"DOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-DOMString"}],"title":"6.1. LP2PReceiverOptions"},{"refs":[{"id":"ref-for-idl-DOMString\u2460"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-idl-DOMString\u2461"}],"title":"7.1. LP2PRequestOptions"},{"refs":[{"id":"ref-for-idl-DOMString\u2462"}],"title":"9.5. LP2PDataChannelEvent"}],"url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-Exposed\u2460"}],"title":"6.1. LP2PReceiverOptions"},{"refs":[{"id":"ref-for-Exposed\u2461"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-Exposed\u2462"}],"title":"7. The LP2PRequest Interface"},{"refs":[{"id":"ref-for-Exposed\u2463"}],"title":"7.1. LP2PRequestOptions"},{"refs":[{"id":"ref-for-Exposed\u2464"}],"title":"8. The LP2PConnection Interface"},{"refs":[{"id":"ref-for-Exposed\u2465"}],"title":"8.1. LP2PQuicTransport Interface Extensions"},{"refs":[{"id":"ref-for-Exposed\u2466"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-Exposed\u2467"}],"title":"9.1. LP2PDataChannelInit"},{"refs":[{"id":"ref-for-Exposed\u2468"}],"title":"9.4. LP2PConnection Interface Extensions"},{"refs":[{"id":"ref-for-Exposed\u2460\u24ea"}],"title":"9.5. LP2PDataChannelEvent"},{"refs":[{"id":"ref-for-Exposed\u2460\u2460"},{"id":"ref-for-Exposed\u2460\u2461"}],"title":"10. The LP2PQuicTransport Interface"},{"refs":[{"id":"ref-for-Exposed\u2460\u2462"},{"id":"ref-for-Exposed\u2460\u2463"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"88d6f55f": {"dfnID":"88d6f55f","dfnText":"BinaryType","external":true,"refSections":[{"refs":[{"id":"ref-for-enumdef-binarytype"}],"title":"9. The LP2PDataChannel Interface"}],"url":"https://websockets.spec.whatwg.org/#enumdef-binarytype"},
"9d386f55": {"dfnID":"9d386f55","dfnText":"event handler event type","external":true,"refSections":[{"refs":[{"id":"ref-for-event-handler-event-type"},{"id":"ref-for-event-handler-event-type\u2460"}],"title":"6.4. Event handlers"},{"refs":[{"id":"ref-for-event-handler-event-type\u2461"},{"id":"ref-for-event-handler-event-type\u2462"}],"title":"9.3. Event handlers"},{"refs":[{"id":"ref-for-event-handler-event-type\u2463"},{"id":"ref-for-event-handler-event-type\u2464"}],"title":"9.7. Extensions Event handlers"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"},
"acquire-a-local-peer-grant": {"dfnID":"acquire-a-local-peer-grant","dfnText":"acquire a local peer grant","external":false,"refSections":[{"refs":[{"id":"ref-for-acquire-a-local-peer-grant"}],"title":"3. Peer Management"},{"refs":[{"id":"ref-for-acquire-a-local-peer-grant\u2460"}],"title":"3.3. Peer discovery"},{"refs":[{"id":"ref-for-acquire-a-local-peer-grant\u2461"}],"title":"3.5. Peer grant"},{"refs":[{"id":"ref-for-acquire-a-local-peer-grant\u2462"}],"title":"11.5. Device Access"}],"url":"#acquire-a-local-peer-grant"},
"agent-capability": {"dfnID":"agent-capability","dfnText":"agent-capability","external":false,"refSections":[{"refs":[{"id":"ref-for-agent-capability"}],"title":"4.1. Data channel extension"},{"refs":[{"id":"ref-for-agent-capability\u2460"}],"title":"4.2. WebTransport extension"}],"url":"#agent-capability"},
"authenticate-a-local-peer": {"dfnID":"authenticate-a-local-peer","dfnText":"authenticate a local peer","external":false,"refSections":[{"refs":[{"id":"ref-for-authenticate-a-local-peer"}],"title":"3.5. Peer grant"},{"refs":[{"id":"ref-for-authenticate-a-local-peer\u2460"}],"title":"11.5. Device Access"}],"url":"#authenticate-a-local-peer"},
"authenticated": {"dfnID":"authenticated","dfnText":"authenticated","external":false,"refSections":[{"refs":[{"id":"ref-for-authenticated"}],"title":"3.5. Peer grant"},{"refs":[{"id":"ref-for-authenticated\u2460"}],"title":"5. Local HTTPS"},{"refs":[{"id":"ref-for-authenticated\u2461"}],"title":"5.1. Endpoint discovery"}],"url":"#authenticated"},
"authentication-state": {"dfnID":"authentication-state","dfnText":"authentication state","external":false,"refSections":[{"refs":[{"id":"ref-for-authentication-state"},{"id":"ref-for-authentication-state\u2460"},{"id":"ref-for-authentication-state\u2461"}],"title":"3.1. Known peers"},{"refs":[{"id":"ref-for-authentication-state\u2462"},{"id":"ref-for-authentication-state\u2463"}],"title":"3.4. Peer authentication"}],"url":"#authentication-state"},
"b0d7f3c3": {"dfnID":"b0d7f3c3","dfnText":"USVString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-USVString"},{"id":"ref-for-idl-USVString\u2460"},{"id":"ref-for-idl-USVString\u2461"},{"id":"ref-for-idl-USVString\u2462"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-idl-USVString\u2463"}],"title":"9.1. LP2PDataChannelInit"},{"refs":[{"id":"ref-for-idl-USVString\u2464"}],"title":"9.4. LP2PConnection Interface Extensions"}],"url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"b75bb3bd": {"dfnID":"b75bb3bd","dfnText":"SecureContext","external":true,"refSections":[{"refs":[{"id":"ref-for-SecureContext"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-SecureContext\u2460"}],"title":"6.1. LP2PReceiverOptions"},{"refs":[{"id":"ref-for-SecureContext\u2461"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-SecureContext\u2462"}],"title":"7. The LP2PRequest Interface"},{"refs":[{"id":"ref-for-SecureContext\u2463"}],"title":"7.1. LP2PRequestOptions"},{"refs":[{"id":"ref-for-SecureContext\u2464"}],"title":"8. The LP2PConnection Interface"},{"refs":[{"id":"ref-for-SecureContext\u2465"}],"title":"8.1. LP2PQuicTransport Interface Extensions"},{"refs":[{"id":"ref-for-SecureContext\u2466"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-SecureContext\u2467"}],"title":"9.1. LP2PDataChannelInit"},{"refs":[{"id":"ref-for-SecureContext\u2468"}],"title":"9.4. LP2PConnection Interface Extensions"},{"refs":[{"id":"ref-for-SecureContext\u2460\u24ea"}],"title":"9.5. LP2PDataChannelEvent"},{"refs":[{"id":"ref-for-SecureContext\u2460\u2460"},{"id":"ref-for-SecureContext\u2460\u2461"}],"title":"10. The LP2PQuicTransport Interface"},{"refs":[{"id":"ref-for-SecureContext\u2460\u2462"},{"id":"ref-for-SecureContext\u2460\u2463"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"https://webidl.spec.whatwg.org/#SecureContext"},
"b7d73f5b": {"dfnID":"b7d73f5b","dfnText":"Blob","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-Blob"}],"title":"9. The LP2PDataChannel Interface"}],"url":"https://w3c.github.io/FileAPI/#dfn-Blob"},
"bdbd19d1": {"dfnID":"bdbd19d1","dfnText":"Promise","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-promise"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-idl-promise\u2460"}],"title":"7. The LP2PRequest Interface"},{"refs":[{"id":"ref-for-idl-promise\u2461"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"https://webidl.spec.whatwg.org/#idl-promise"},
"c01cbda0": {"dfnID":"c01cbda0","dfnText":"EnforceRange","external":true,"refSections":[{"refs":[{"id":"ref-for-EnforceRange"}],"title":"9.1. LP2PDataChannelInit"}],"url":"https://webidl.spec.whatwg.org/#EnforceRange"},
"cc890cc1": {"dfnID":"cc890cc1","dfnText":"policy-controlled feature","external":true,"refSections":[{"refs":[{"id":"ref-for-policy-controlled-feature"},{"id":"ref-for-policy-controlled-feature\u2460"}],"title":"2. Permission Policy Integration"}],"url":"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature"},
"data-channel-encoding-id": {"dfnID":"data-channel-encoding-id","dfnText":"data-channel-encoding-id","external":false,"refSections":[{"refs":[{"id":"ref-for-data-channel-encoding-id"}],"title":"4.1. Data channel extension"}],"url":"#data-channel-encoding-id"},
"data-channel-open-request": {"dfnID":"data-channel-open-request","dfnText":"data-channel-open-request","external":false,"refSections":[{"refs":[{"id":"ref-for-data-channel-open-request"},{"id":"ref-for-data-channel-open-request\u2460"}],"title":"4.1. Data channel extension"}],"url":"#data-channel-open-request"},
"data-channel-open-response": {"dfnID":"data-channel-open-response","dfnText":"data-channel-open-response","external":false,"refSections":[{"refs":[{"id":"ref-for-data-channel-open-response"},{"id":"ref-for-data-channel-open-response\u2460"}],"title":"4.1. Data channel extension"}],"url":"#data-channel-open-response"},
"data-channels": {"dfnID":"data-channels","dfnText":"data-channels","external":false,"refSections":[{"refs":[{"id":"ref-for-data-channels"}],"title":"4.1. Data channel extension"}],"url":"#data-channels"},
"data-frame": {"dfnID":"data-frame","dfnText":"data-frame","external":false,"refSections":[{"refs":[{"id":"ref-for-data-frame"}],"title":"4.1. Data channel extension"}],"url":"#data-frame"},
"dictdef-lp2pconnectioneventinit": {"dfnID":"dictdef-lp2pconnectioneventinit","dfnText":"LP2PConnectionEventInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2pconnectioneventinit"}],"title":"6.2. LP2PConnectionEvent"}],"url":"#dictdef-lp2pconnectioneventinit"},
"dictdef-lp2pdatachanneleventinit": {"dfnID":"dictdef-lp2pdatachanneleventinit","dfnText":"LP2PDataChannelEventInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2pdatachanneleventinit"}],"title":"9.5. LP2PDataChannelEvent"}],"url":"#dictdef-lp2pdatachanneleventinit"},
"dictdef-lp2pdatachannelinit": {"dfnID":"dictdef-lp2pdatachannelinit","dfnText":"LP2PDataChannelInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2pdatachannelinit"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-dictdef-lp2pdatachannelinit\u2460"}],"title":"9.4. LP2PConnection Interface Extensions"}],"url":"#dictdef-lp2pdatachannelinit"},
"dictdef-lp2pquictransportinit": {"dfnID":"dictdef-lp2pquictransportinit","dfnText":"LP2PQuicTransportInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2pquictransportinit"}],"title":"8.1. LP2PQuicTransport Interface Extensions"},{"refs":[{"id":"ref-for-dictdef-lp2pquictransportinit\u2460"}],"title":"10. The LP2PQuicTransport Interface"}],"url":"#dictdef-lp2pquictransportinit"},
"dictdef-lp2pquictransportlistenerinit": {"dfnID":"dictdef-lp2pquictransportlistenerinit","dfnText":"LP2PQuicTransportListenerInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2pquictransportlistenerinit"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"#dictdef-lp2pquictransportlistenerinit"},
"dictdef-lp2preceiveroptions": {"dfnID":"dictdef-lp2preceiveroptions","dfnText":"LP2PReceiverOptions","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2preceiveroptions"}],"title":"6. LP2PReceiver Interface"}],"url":"#dictdef-lp2preceiveroptions"},
"dictdef-lp2prequestoptions": {"dfnID":"dictdef-lp2prequestoptions","dfnText":"LP2PRequestOptions","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-lp2prequestoptions"}],"title":"7. The LP2PRequest Interface"}],"url":"#dictdef-lp2prequestoptions"},
"dom-lp2pconnection-createdatachannel": {"dfnID":"dom-lp2pconnection-createdatachannel","dfnText":"createDataChannel","external":false,"refSections":[],"url":"#dom-lp2pconnection-createdatachannel"},
"dom-lp2pconnection-createdatachannel-label-datachanneldict-datachanneldict": {"dfnID":"dom-lp2pconnection-createdatachannel-label-datachanneldict-datachanneldict","dfnText":"dataChannelDict","external":false,"refSections":[],"url":"#dom-lp2pconnection-createdatachannel-label-datachanneldict-datachanneldict"},
"dom-lp2pconnection-createdatachannel-label-datachanneldict-label": {"dfnID":"dom-lp2pconnection-createdatachannel-label-datachanneldict-label","dfnText":"label","external":false,"refSections":[],"url":"#dom-lp2pconnection-createdatachannel-label-datachanneldict-label"},
"dom-lp2pconnection-ondatachannel": {"dfnID":"dom-lp2pconnection-ondatachannel","dfnText":"ondatachannel","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pconnection-ondatachannel"}],"title":"9.4. LP2PConnection Interface Extensions"}],"url":"#dom-lp2pconnection-ondatachannel"},
"dom-lp2pconnectionevent-connection": {"dfnID":"dom-lp2pconnectionevent-connection","dfnText":"connection","external":false,"refSections":[],"url":"#dom-lp2pconnectionevent-connection"},
"dom-lp2pconnectionevent-lp2pconnectionevent": {"dfnID":"dom-lp2pconnectionevent-lp2pconnectionevent","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pconnectionevent-lp2pconnectionevent"},
"dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-connectioneventinitdict": {"dfnID":"dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-connectioneventinitdict","dfnText":"connectionEventInitDict","external":false,"refSections":[],"url":"#dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-connectioneventinitdict"},
"dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-type": {"dfnID":"dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-type","dfnText":"type","external":false,"refSections":[],"url":"#dom-lp2pconnectionevent-lp2pconnectionevent-type-connectioneventinitdict-type"},
"dom-lp2pconnectioneventinit-connection": {"dfnID":"dom-lp2pconnectioneventinit-connection","dfnText":"connection","external":false,"refSections":[],"url":"#dom-lp2pconnectioneventinit-connection"},
"dom-lp2pdatachannel-binarytype": {"dfnID":"dom-lp2pdatachannel-binarytype","dfnText":"binaryType","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-binarytype"},
"dom-lp2pdatachannel-close": {"dfnID":"dom-lp2pdatachannel-close","dfnText":"close","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-close"},
"dom-lp2pdatachannel-id": {"dfnID":"dom-lp2pdatachannel-id","dfnText":"id","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-id"},
"dom-lp2pdatachannel-label": {"dfnID":"dom-lp2pdatachannel-label","dfnText":"label","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-label"},
"dom-lp2pdatachannel-lp2pdatachannel": {"dfnID":"dom-lp2pdatachannel-lp2pdatachannel","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-lp2pdatachannel"},
"dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-datachanneldict": {"dfnID":"dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-datachanneldict","dfnText":"dataChannelDict","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-datachanneldict"},
"dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-label": {"dfnID":"dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-label","dfnText":"label","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-lp2pdatachannel-label-datachanneldict-label"},
"dom-lp2pdatachannel-onclose": {"dfnID":"dom-lp2pdatachannel-onclose","dfnText":"onclose","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pdatachannel-onclose"}],"title":"9. The LP2PDataChannel Interface"}],"url":"#dom-lp2pdatachannel-onclose"},
"dom-lp2pdatachannel-onclosing": {"dfnID":"dom-lp2pdatachannel-onclosing","dfnText":"onclosing","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pdatachannel-onclosing"}],"title":"9. The LP2PDataChannel Interface"}],"url":"#dom-lp2pdatachannel-onclosing"},
"dom-lp2pdatachannel-onerror": {"dfnID":"dom-lp2pdatachannel-onerror","dfnText":"onerror","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pdatachannel-onerror"}],"title":"9. The LP2PDataChannel Interface"}],"url":"#dom-lp2pdatachannel-onerror"},
"dom-lp2pdatachannel-onmessage": {"dfnID":"dom-lp2pdatachannel-onmessage","dfnText":"onmessage","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pdatachannel-onmessage"}],"title":"9. The LP2PDataChannel Interface"}],"url":"#dom-lp2pdatachannel-onmessage"},
"dom-lp2pdatachannel-onopen": {"dfnID":"dom-lp2pdatachannel-onopen","dfnText":"onopen","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2pdatachannel-onopen"}],"title":"9. The LP2PDataChannel Interface"}],"url":"#dom-lp2pdatachannel-onopen"},
"dom-lp2pdatachannel-protocol": {"dfnID":"dom-lp2pdatachannel-protocol","dfnText":"protocol","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-protocol"},
"dom-lp2pdatachannel-send": {"dfnID":"dom-lp2pdatachannel-send","dfnText":"send","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-send"},
"dom-lp2pdatachannel-send-data-data": {"dfnID":"dom-lp2pdatachannel-send-data-data","dfnText":"data","external":false,"refSections":[],"url":"#dom-lp2pdatachannel-send-data-data"},
"dom-lp2pdatachannelevent-channel": {"dfnID":"dom-lp2pdatachannelevent-channel","dfnText":"channel","external":false,"refSections":[],"url":"#dom-lp2pdatachannelevent-channel"},
"dom-lp2pdatachannelevent-lp2pdatachannelevent": {"dfnID":"dom-lp2pdatachannelevent-lp2pdatachannelevent","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pdatachannelevent-lp2pdatachannelevent"},
"dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-datachanneleventinitdict": {"dfnID":"dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-datachanneleventinitdict","dfnText":"DataChannelEventInitDict","external":false,"refSections":[],"url":"#dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-datachanneleventinitdict"},
"dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-type": {"dfnID":"dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-type","dfnText":"type","external":false,"refSections":[],"url":"#dom-lp2pdatachannelevent-lp2pdatachannelevent-type-datachanneleventinitdict-type"},
"dom-lp2pdatachanneleventinit-channel": {"dfnID":"dom-lp2pdatachanneleventinit-channel","dfnText":"channel","external":false,"refSections":[],"url":"#dom-lp2pdatachanneleventinit-channel"},
"dom-lp2pdatachannelinit-id": {"dfnID":"dom-lp2pdatachannelinit-id","dfnText":"id","external":false,"refSections":[],"url":"#dom-lp2pdatachannelinit-id"},
"dom-lp2pdatachannelinit-protocol": {"dfnID":"dom-lp2pdatachannelinit-protocol","dfnText":"protocol","external":false,"refSections":[],"url":"#dom-lp2pdatachannelinit-protocol"},
"dom-lp2pquictransport-lp2pquictransport": {"dfnID":"dom-lp2pquictransport-lp2pquictransport","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport"},
"dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-connection": {"dfnID":"dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-connection","dfnText":"connection","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-connection"},
"dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-quictransportdict": {"dfnID":"dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-quictransportdict","dfnText":"quicTransportDict","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport-connection-quictransportdict-quictransportdict"},
"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict": {"dfnID":"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict"},
"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-quictransportdict": {"dfnID":"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-quictransportdict","dfnText":"quicTransportDict","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-quictransportdict"},
"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-source": {"dfnID":"dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-source","dfnText":"source","external":false,"refSections":[],"url":"#dom-lp2pquictransport-lp2pquictransport-source-quictransportdict-source"},
"dom-lp2pquictransportlistener-incomingtransports": {"dfnID":"dom-lp2pquictransportlistener-incomingtransports","dfnText":"incomingTransports","external":false,"refSections":[],"url":"#dom-lp2pquictransportlistener-incomingtransports"},
"dom-lp2pquictransportlistener-lp2pquictransportlistener": {"dfnID":"dom-lp2pquictransportlistener-lp2pquictransportlistener","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2pquictransportlistener-lp2pquictransportlistener"},
"dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-quictransportlistenerdict": {"dfnID":"dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-quictransportlistenerdict","dfnText":"quicTransportListenerDict","external":false,"refSections":[],"url":"#dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-quictransportlistenerdict"},
"dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-source": {"dfnID":"dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-source","dfnText":"source","external":false,"refSections":[],"url":"#dom-lp2pquictransportlistener-lp2pquictransportlistener-source-quictransportlistenerdict-source"},
"dom-lp2pquictransportlistener-ready": {"dfnID":"dom-lp2pquictransportlistener-ready","dfnText":"ready","external":false,"refSections":[],"url":"#dom-lp2pquictransportlistener-ready"},
"dom-lp2preceiver-lp2preceiver": {"dfnID":"dom-lp2preceiver-lp2preceiver","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2preceiver-lp2preceiver"},
"dom-lp2preceiver-lp2preceiver-options-options": {"dfnID":"dom-lp2preceiver-lp2preceiver-options-options","dfnText":"options","external":false,"refSections":[],"url":"#dom-lp2preceiver-lp2preceiver-options-options"},
"dom-lp2preceiver-onconnection": {"dfnID":"dom-lp2preceiver-onconnection","dfnText":"onconnection","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-lp2preceiver-onconnection"}],"title":"6. LP2PReceiver Interface"}],"url":"#dom-lp2preceiver-onconnection"},
"dom-lp2preceiver-start": {"dfnID":"dom-lp2preceiver-start","dfnText":"start","external":false,"refSections":[],"url":"#dom-lp2preceiver-start"},
"dom-lp2preceiveroptions-nickname": {"dfnID":"dom-lp2preceiveroptions-nickname","dfnText":"nickname","external":false,"refSections":[],"url":"#dom-lp2preceiveroptions-nickname"},
"dom-lp2prequest-lp2prequest": {"dfnID":"dom-lp2prequest-lp2prequest","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-lp2prequest-lp2prequest"},
"dom-lp2prequest-lp2prequest-options-options": {"dfnID":"dom-lp2prequest-lp2prequest-options-options","dfnText":"options","external":false,"refSections":[],"url":"#dom-lp2prequest-lp2prequest-options-options"},
"dom-lp2prequest-start": {"dfnID":"dom-lp2prequest-start","dfnText":"start","external":false,"refSections":[],"url":"#dom-lp2prequest-start"},
"dom-lp2prequestoptions-nickname": {"dfnID":"dom-lp2prequestoptions-nickname","dfnText":"nickname","external":false,"refSections":[],"url":"#dom-lp2prequestoptions-nickname"},
"encoding-id-array-buffer": {"dfnID":"encoding-id-array-buffer","dfnText":"encoding-id-array-buffer","external":false,"refSections":[{"refs":[{"id":"ref-for-encoding-id-array-buffer"}],"title":"4.1. Data channel extension"}],"url":"#encoding-id-array-buffer"},
"encoding-id-blob": {"dfnID":"encoding-id-blob","dfnText":"encoding-id-blob","external":false,"refSections":[{"refs":[{"id":"ref-for-encoding-id-blob"}],"title":"4.1. Data channel extension"}],"url":"#encoding-id-blob"},
"encoding-id-string": {"dfnID":"encoding-id-string","dfnText":"encoding-id-string","external":false,"refSections":[{"refs":[{"id":"ref-for-encoding-id-string"}],"title":"4.1. Data channel extension"}],"url":"#encoding-id-string"},
"establish-local-peer-connection": {"dfnID":"establish-local-peer-connection","dfnText":"establish local peer connection","external":false,"refSections":[{"refs":[{"id":"ref-for-establish-local-peer-connection"}],"title":"3. Peer Management"}],"url":"#establish-local-peer-connection"},
"eventdef-lp2pconnection-datachannel": {"dfnID":"eventdef-lp2pconnection-datachannel","dfnText":"datachannel","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pconnection-datachannel"}],"title":"9.7. Extensions Event handlers"}],"url":"#eventdef-lp2pconnection-datachannel"},
"eventdef-lp2pdatachannel-close": {"dfnID":"eventdef-lp2pdatachannel-close","dfnText":"close","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pdatachannel-close"}],"title":"9.3. Event handlers"}],"url":"#eventdef-lp2pdatachannel-close"},
"eventdef-lp2pdatachannel-closing": {"dfnID":"eventdef-lp2pdatachannel-closing","dfnText":"closing","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pdatachannel-closing"}],"title":"9.3. Event handlers"}],"url":"#eventdef-lp2pdatachannel-closing"},
"eventdef-lp2pdatachannel-error": {"dfnID":"eventdef-lp2pdatachannel-error","dfnText":"error","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pdatachannel-error"}],"title":"9.3. Event handlers"}],"url":"#eventdef-lp2pdatachannel-error"},
"eventdef-lp2pdatachannel-message": {"dfnID":"eventdef-lp2pdatachannel-message","dfnText":"message","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pdatachannel-message"}],"title":"9.3. Event handlers"}],"url":"#eventdef-lp2pdatachannel-message"},
"eventdef-lp2pdatachannel-open": {"dfnID":"eventdef-lp2pdatachannel-open","dfnText":"open","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2pdatachannel-open"}],"title":"9.3. Event handlers"}],"url":"#eventdef-lp2pdatachannel-open"},
"eventdef-lp2preceiver-connection": {"dfnID":"eventdef-lp2preceiver-connection","dfnText":"connection","external":false,"refSections":[{"refs":[{"id":"ref-for-eventdef-lp2preceiver-connection"}],"title":"6.4. Event handlers"}],"url":"#eventdef-lp2preceiver-connection"},
"f0951476": {"dfnID":"f0951476","dfnText":"EventHandler","external":true,"refSections":[{"refs":[{"id":"ref-for-eventhandler"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-eventhandler\u2460"},{"id":"ref-for-eventhandler\u2461"},{"id":"ref-for-eventhandler\u2462"},{"id":"ref-for-eventhandler\u2463"},{"id":"ref-for-eventhandler\u2464"}],"title":"9. The LP2PDataChannel Interface"},{"refs":[{"id":"ref-for-eventhandler\u2465"}],"title":"9.4. LP2PConnection Interface Extensions"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"},
"known-peer": {"dfnID":"known-peer","dfnText":"known peer","external":false,"refSections":[{"refs":[{"id":"ref-for-known-peer"}],"title":"3.1. Known peers"},{"refs":[{"id":"ref-for-known-peer\u2460"}],"title":"3.5. Peer grant"}],"url":"#known-peer"},
"known-peers-map": {"dfnID":"known-peers-map","dfnText":"known peers map","external":false,"refSections":[{"refs":[{"id":"ref-for-known-peers-map"}],"title":"3.2. Peer advertisement"},{"refs":[{"id":"ref-for-known-peers-map\u2460"}],"title":"3.3. Peer discovery"}],"url":"#known-peers-map"},
"local-peer-to-peer-manager": {"dfnID":"local-peer-to-peer-manager","dfnText":"local peer-to-peer manager","external":false,"refSections":[{"refs":[{"id":"ref-for-local-peer-to-peer-manager"}],"title":"3.1. Known peers"}],"url":"#local-peer-to-peer-manager"},
"lp2pconnection": {"dfnID":"lp2pconnection","dfnText":"LP2PConnection","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pconnection"},{"id":"ref-for-lp2pconnection\u2460"}],"title":"6.2. LP2PConnectionEvent"},{"refs":[{"id":"ref-for-lp2pconnection\u2461"}],"title":"7. The LP2PRequest Interface"},{"refs":[{"id":"ref-for-lp2pconnection\u2462"}],"title":"8. The LP2PConnection Interface"},{"refs":[{"id":"ref-for-lp2pconnection\u2463"}],"title":"8.1. LP2PQuicTransport Interface Extensions"},{"refs":[{"id":"ref-for-lp2pconnection\u2464"}],"title":"9.4. LP2PConnection Interface Extensions"},{"refs":[{"id":"ref-for-lp2pconnection\u2465"}],"title":"9.6. Extensions Events"},{"refs":[{"id":"ref-for-lp2pconnection\u2466"}],"title":"9.7. Extensions Event handlers"}],"url":"#lp2pconnection"},
"lp2pconnectionevent": {"dfnID":"lp2pconnectionevent","dfnText":"LP2PConnectionEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pconnectionevent"}],"title":"6.3. Events"}],"url":"#lp2pconnectionevent"},
"lp2pdatachannel": {"dfnID":"lp2pdatachannel","dfnText":"LP2PDataChannel","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pdatachannel"}],"title":"9.2. Events"},{"refs":[{"id":"ref-for-lp2pdatachannel\u2460"}],"title":"9.4. LP2PConnection Interface Extensions"},{"refs":[{"id":"ref-for-lp2pdatachannel\u2461"},{"id":"ref-for-lp2pdatachannel\u2462"}],"title":"9.5. LP2PDataChannelEvent"},{"refs":[{"id":"ref-for-lp2pdatachannel\u2463"},{"id":"ref-for-lp2pdatachannel\u2464"}],"title":"9.8. Examples"}],"url":"#lp2pdatachannel"},
"lp2pdatachannelevent": {"dfnID":"lp2pdatachannelevent","dfnText":"LP2PDataChannelEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pdatachannelevent"}],"title":"9.6. Extensions Events"}],"url":"#lp2pdatachannelevent"},
"lp2pquictransport": {"dfnID":"lp2pquictransport","dfnText":"LP2PQuicTransport","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pquictransport"},{"id":"ref-for-lp2pquictransport\u2460"}],"title":"8.1. LP2PQuicTransport Interface Extensions"},{"refs":[{"id":"ref-for-lp2pquictransport\u2461"},{"id":"ref-for-lp2pquictransport\u2462"}],"title":"8.2. Examples"},{"refs":[{"id":"ref-for-lp2pquictransport\u2463"}],"title":"10. The LP2PQuicTransport Interface"}],"url":"#lp2pquictransport"},
"lp2pquictransportlistener": {"dfnID":"lp2pquictransportlistener","dfnText":"LP2PQuicTransportListener","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2pquictransportlistener"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"#lp2pquictransportlistener"},
"lp2preceiver": {"dfnID":"lp2preceiver","dfnText":"LP2PReceiver","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2preceiver"}],"title":"6. LP2PReceiver Interface"},{"refs":[{"id":"ref-for-lp2preceiver\u2460"}],"title":"6.3. Events"},{"refs":[{"id":"ref-for-lp2preceiver\u2461"}],"title":"10. The LP2PQuicTransport Interface"},{"refs":[{"id":"ref-for-lp2preceiver\u2462"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"#lp2preceiver"},
"lp2prequest": {"dfnID":"lp2prequest","dfnText":"LP2PRequest","external":false,"refSections":[{"refs":[{"id":"ref-for-lp2prequest"}],"title":"7. The LP2PRequest Interface"},{"refs":[{"id":"ref-for-lp2prequest\u2460"}],"title":"10. The LP2PQuicTransport Interface"},{"refs":[{"id":"ref-for-lp2prequest\u2461"}],"title":"10.1. LP2PQuicTransportListener Interface"}],"url":"#lp2prequest"},
"open-a-data-channel": {"dfnID":"open-a-data-channel","dfnText":"open a data channel","external":false,"refSections":[{"refs":[{"id":"ref-for-open-a-data-channel"}],"title":"4. Protocol concepts"}],"url":"#open-a-data-channel"},
"open-a-webtransport-session": {"dfnID":"open-a-webtransport-session","dfnText":"open a WebTransport session","external":false,"refSections":[{"refs":[{"id":"ref-for-open-a-webtransport-session"}],"title":"4. Protocol concepts"},{"refs":[{"id":"ref-for-open-a-webtransport-session\u2460"}],"title":"4.2. WebTransport extension"}],"url":"#open-a-webtransport-session"},
"peer": {"dfnID":"peer","dfnText":"peer","external":false,"refSections":[{"refs":[{"id":"ref-for-peer"}],"title":"3. Peer Management"},{"refs":[{"id":"ref-for-peer\u2460"}],"title":"3.1. Known peers"}],"url":"#peer"},
"peer-grant-state": {"dfnID":"peer-grant-state","dfnText":"peer grant state","external":false,"refSections":[{"refs":[{"id":"ref-for-peer-grant-state"},{"id":"ref-for-peer-grant-state\u2460"},{"id":"ref-for-peer-grant-state\u2461"}],"title":"3.1. Known peers"},{"refs":[{"id":"ref-for-peer-grant-state\u2462"}],"title":"3.5. Peer grant"}],"url":"#peer-grant-state"},
"persisted": {"dfnID":"persisted","dfnText":"persisted","external":false,"refSections":[{"refs":[{"id":"ref-for-persisted"}],"title":"3.1. Known peers"},{"refs":[{"id":"ref-for-persisted\u2460"}],"title":"3.5. Peer grant"}],"url":"#persisted"},
"protocol-local-peer-to-peer-session": {"dfnID":"protocol-local-peer-to-peer-session","dfnText":"Local Peer-to-Peer session","external":false,"refSections":[{"refs":[{"id":"ref-for-protocol-local-peer-to-peer-session"}],"title":"4. Protocol concepts"},{"refs":[{"id":"ref-for-protocol-local-peer-to-peer-session\u2460"}],"title":"4.1. Data channel extension"}],"url":"#protocol-local-peer-to-peer-session"},
"quick-transport": {"dfnID":"quick-transport","dfnText":"quick-transport","external":false,"refSections":[{"refs":[{"id":"ref-for-quick-transport"}],"title":"4.2. WebTransport extension"}],"url":"#quick-transport"},
"send-data-on-a-channel": {"dfnID":"send-data-on-a-channel","dfnText":"send data on a channel","external":false,"refSections":[{"refs":[{"id":"ref-for-send-data-on-a-channel"}],"title":"4. Protocol concepts"},{"refs":[{"id":"ref-for-send-data-on-a-channel\u2460"}],"title":"4.2. WebTransport extension"}],"url":"#send-data-on-a-channel"},
"session-advertise-agent": {"dfnID":"session-advertise-agent","dfnText":"advertise agent","external":false,"refSections":[{"refs":[{"id":"ref-for-session-advertise-agent"}],"title":"3.2. Peer advertisement"}],"url":"#session-advertise-agent"},
"session-authenticate-an-agent": {"dfnID":"session-authenticate-an-agent","dfnText":"authenticate an agent","external":false,"refSections":[{"refs":[{"id":"ref-for-session-authenticate-an-agent"},{"id":"ref-for-session-authenticate-an-agent\u2460"}],"title":"3.4. Peer authentication"},{"refs":[{"id":"ref-for-session-authenticate-an-agent\u2461"}],"title":"4.2. WebTransport extension"}],"url":"#session-authenticate-an-agent"},
"session-discover-agents": {"dfnID":"session-discover-agents","dfnText":"discover agents","external":false,"refSections":[{"refs":[{"id":"ref-for-session-discover-agents"},{"id":"ref-for-session-discover-agents\u2460"}],"title":"3.3. Peer discovery"}],"url":"#session-discover-agents"},
"session-discover-metadata": {"dfnID":"session-discover-metadata","dfnText":"discover metadata","external":false,"refSections":[{"refs":[{"id":"ref-for-session-discover-metadata"}],"title":"4.1. Data channel extension"},{"refs":[{"id":"ref-for-session-discover-metadata\u2460"}],"title":"4.2. WebTransport extension"}],"url":"#session-discover-metadata"},
"start-local-peer-discovery": {"dfnID":"start-local-peer-discovery","dfnText":"start local peer discovery","external":false,"refSections":[{"refs":[{"id":"ref-for-start-local-peer-discovery"}],"title":"3. Peer Management"}],"url":"#start-local-peer-discovery"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getRootLevelAbsolutePosition(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// Returns the root-level absolute position {left and top} of element.
function getRootLevelAbsolutePosition(el) {
    const boundsRect = el.getBoundingClientRect();
    let xPos = 0;
    let yPos = 0;

    while (el) {
        let xScroll = el.scrollLeft;
        let yScroll = el.scrollTop;

        // Ignore scrolling of body.
        if (el.tagName === "BODY") {
            xScroll = 0;
            yScroll = 0;
        }
        xPos += (el.offsetLeft - xScroll + el.clientLeft);
        yPos += (el.offsetTop - yScroll + el.clientTop);

        el = el.offsetParent;
    }
    return {
        left: xPos,
        top: yPos,
        right: xPos + boundsRect.width,
        bottom: yPos + boundsRect.height,
    };
}

function scrolledIntoView(element) {
    const rect = element.getBoundingClientRect();
    return (
        rect.top > 0 &&
        rect.bottom < window.innerHeight
    );
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            // Maybe prevent default scroll.
            if (scrolledIntoView(dest)) {
                event.preventDefault();
            }
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#acquire-a-local-peer-grant": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"acquire a local peer grant","type":"dfn","url":"#acquire-a-local-peer-grant"},
"#agent-capability": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"agent-capability","type":"dfn","url":"#agent-capability"},
"#authenticate-a-local-peer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"authenticate a local peer","type":"dfn","url":"#authenticate-a-local-peer"},
"#authenticated": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"authenticated","type":"dfn","url":"#authenticated"},
"#authentication-state": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"authentication state","type":"dfn","url":"#authentication-state"},
"#data-channel-encoding-id": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"data-channel-encoding-id","type":"dfn","url":"#data-channel-encoding-id"},
"#data-channel-open-request": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"data-channel-open-request","type":"dfn","url":"#data-channel-open-request"},
"#data-channel-open-response": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"data-channel-open-response","type":"dfn","url":"#data-channel-open-response"},
"#data-channels": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"data-channels","type":"dfn","url":"#data-channels"},
"#data-frame": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"data-frame","type":"dfn","url":"#data-frame"},
"#dictdef-lp2pconnectioneventinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PConnectionEventInit","type":"dictionary","url":"#dictdef-lp2pconnectioneventinit"},
"#dictdef-lp2pdatachanneleventinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PDataChannelEventInit","type":"dictionary","url":"#dictdef-lp2pdatachanneleventinit"},
"#dictdef-lp2pdatachannelinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PDataChannelInit","type":"dictionary","url":"#dictdef-lp2pdatachannelinit"},
"#dictdef-lp2pquictransportinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PQuicTransportInit","type":"dictionary","url":"#dictdef-lp2pquictransportinit"},
"#dictdef-lp2pquictransportlistenerinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PQuicTransportListenerInit","type":"dictionary","url":"#dictdef-lp2pquictransportlistenerinit"},
"#dictdef-lp2preceiveroptions": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PReceiverOptions","type":"dictionary","url":"#dictdef-lp2preceiveroptions"},
"#dictdef-lp2prequestoptions": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PRequestOptions","type":"dictionary","url":"#dictdef-lp2prequestoptions"},
"#dom-lp2pconnection-ondatachannel": {"export":true,"for_":["LP2PConnection"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"ondatachannel","type":"attribute","url":"#dom-lp2pconnection-ondatachannel"},
"#dom-lp2pdatachannel-onclose": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onclose","type":"attribute","url":"#dom-lp2pdatachannel-onclose"},
"#dom-lp2pdatachannel-onclosing": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onclosing","type":"attribute","url":"#dom-lp2pdatachannel-onclosing"},
"#dom-lp2pdatachannel-onerror": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onerror","type":"attribute","url":"#dom-lp2pdatachannel-onerror"},
"#dom-lp2pdatachannel-onmessage": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onmessage","type":"attribute","url":"#dom-lp2pdatachannel-onmessage"},
"#dom-lp2pdatachannel-onopen": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onopen","type":"attribute","url":"#dom-lp2pdatachannel-onopen"},
"#dom-lp2preceiver-onconnection": {"export":true,"for_":["LP2PReceiver"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"onconnection","type":"attribute","url":"#dom-lp2preceiver-onconnection"},
"#encoding-id-array-buffer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"encoding-id-array-buffer","type":"dfn","url":"#encoding-id-array-buffer"},
"#encoding-id-blob": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"encoding-id-blob","type":"dfn","url":"#encoding-id-blob"},
"#encoding-id-string": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"encoding-id-string","type":"dfn","url":"#encoding-id-string"},
"#establish-local-peer-connection": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"establish local peer connection","type":"dfn","url":"#establish-local-peer-connection"},
"#eventdef-lp2pconnection-datachannel": {"export":true,"for_":["LP2PConnection"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"datachannel","type":"event","url":"#eventdef-lp2pconnection-datachannel"},
"#eventdef-lp2pdatachannel-close": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"close","type":"event","url":"#eventdef-lp2pdatachannel-close"},
"#eventdef-lp2pdatachannel-closing": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"closing","type":"event","url":"#eventdef-lp2pdatachannel-closing"},
"#eventdef-lp2pdatachannel-error": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"error","type":"event","url":"#eventdef-lp2pdatachannel-error"},
"#eventdef-lp2pdatachannel-message": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"message","type":"event","url":"#eventdef-lp2pdatachannel-message"},
"#eventdef-lp2pdatachannel-open": {"export":true,"for_":["LP2PDataChannel"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"open","type":"event","url":"#eventdef-lp2pdatachannel-open"},
"#eventdef-lp2preceiver-connection": {"export":true,"for_":["LP2PReceiver"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"connection","type":"event","url":"#eventdef-lp2preceiver-connection"},
"#known-peer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"known peer","type":"dfn","url":"#known-peer"},
"#known-peers-map": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"known peers map","type":"dfn","url":"#known-peers-map"},
"#local-peer-to-peer-manager": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"local peer-to-peer manager","type":"dfn","url":"#local-peer-to-peer-manager"},
"#lp2pconnection": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PConnection","type":"interface","url":"#lp2pconnection"},
"#lp2pconnectionevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PConnectionEvent","type":"interface","url":"#lp2pconnectionevent"},
"#lp2pdatachannel": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PDataChannel","type":"interface","url":"#lp2pdatachannel"},
"#lp2pdatachannelevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PDataChannelEvent","type":"interface","url":"#lp2pdatachannelevent"},
"#lp2pquictransport": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PQuicTransport","type":"interface","url":"#lp2pquictransport"},
"#lp2pquictransportlistener": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PQuicTransportListener","type":"interface","url":"#lp2pquictransportlistener"},
"#lp2preceiver": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PReceiver","type":"interface","url":"#lp2preceiver"},
"#lp2prequest": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"LP2PRequest","type":"interface","url":"#lp2prequest"},
"#open-a-data-channel": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"open a data channel","type":"dfn","url":"#open-a-data-channel"},
"#open-a-webtransport-session": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"open a webtransport session","type":"dfn","url":"#open-a-webtransport-session"},
"#peer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"peer","type":"dfn","url":"#peer"},
"#peer-grant-state": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"peer grant state","type":"dfn","url":"#peer-grant-state"},
"#persisted": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"persisted","type":"dfn","url":"#persisted"},
"#protocol-local-peer-to-peer-session": {"export":true,"for_":["protocol"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"local peer-to-peer session","type":"dfn","url":"#protocol-local-peer-to-peer-session"},
"#quick-transport": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"quick-transport","type":"dfn","url":"#quick-transport"},
"#send-data-on-a-channel": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"send data on a channel","type":"dfn","url":"#send-data-on-a-channel"},
"#session-advertise-agent": {"export":true,"for_":["session"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"advertise agent","type":"dfn","url":"#session-advertise-agent"},
"#session-authenticate-an-agent": {"export":true,"for_":["session"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"authenticate an agent","type":"dfn","url":"#session-authenticate-an-agent"},
"#session-discover-agents": {"export":true,"for_":["session"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"discover agents","type":"dfn","url":"#session-discover-agents"},
"#session-discover-metadata": {"export":true,"for_":["session"],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"discover metadata","type":"dfn","url":"#session-discover-metadata"},
"#start-local-peer-discovery": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"local-peer-to-peer","spec":"local-peer-to-peer-1","status":"local","text":"start local peer discovery","type":"dfn","url":"#start-local-peer-discovery"},
"https://dom.spec.whatwg.org/#concept-event-fire": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"fire an event","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-event-fire"},
"https://dom.spec.whatwg.org/#dictdef-eventinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"EventInit","type":"dictionary","url":"https://dom.spec.whatwg.org/#dictdef-eventinit"},
"https://dom.spec.whatwg.org/#event": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Event","type":"interface","url":"https://dom.spec.whatwg.org/#event"},
"https://dom.spec.whatwg.org/#eventtarget": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"EventTarget","type":"interface","url":"https://dom.spec.whatwg.org/#eventtarget"},
"https://html.spec.whatwg.org/multipage/browsers.html#same-origin": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"same origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#same-origin"},
"https://html.spec.whatwg.org/multipage/comms.html#messageevent": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"MessageEvent","type":"interface","url":"https://html.spec.whatwg.org/multipage/comms.html#messageevent"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"allowed to use","type":"dfn","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use"},
"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"event handler event type","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type"},
"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"event handler idl attribute","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes"},
"https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"event handler","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers"},
"https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"EventHandler","type":"typedef","url":"https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"},
"https://infra.spec.whatwg.org/#ordered-map": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered map","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-map"},
"https://streams.spec.whatwg.org/#readablestream": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"streams","spec":"streams","status":"current","text":"ReadableStream","type":"interface","url":"https://streams.spec.whatwg.org/#readablestream"},
"https://w3c.github.io/FileAPI/#dfn-Blob": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fileapi","spec":"fileapi","status":"current","text":"Blob","type":"interface","url":"https://w3c.github.io/FileAPI/#dfn-Blob"},
"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"permissions-policy","spec":"permissions-policy-1","status":"current","text":"policy-controlled feature","type":"dfn","url":"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature"},
"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist": {"export":true,"for_":["policy-controlled feature"],"level":"1","normative":true,"shortname":"permissions-policy","spec":"permissions-policy-1","status":"current","text":"default allowlist","type":"dfn","url":"https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature-default-allowlist"},
"https://w3c.github.io/webtransport/#webtransport": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webtransport","spec":"webtransport","status":"current","text":"WebTransport","type":"interface","url":"https://w3c.github.io/webtransport/#webtransport"},
"https://webidl.spec.whatwg.org/#ArrayBufferView": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"ArrayBufferView","type":"typedef","url":"https://webidl.spec.whatwg.org/#ArrayBufferView"},
"https://webidl.spec.whatwg.org/#EnforceRange": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"EnforceRange","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#EnforceRange"},
"https://webidl.spec.whatwg.org/#Exposed": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://webidl.spec.whatwg.org/#SecureContext": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"SecureContext","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#SecureContext"},
"https://webidl.spec.whatwg.org/#idl-ArrayBuffer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"ArrayBuffer","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-ArrayBuffer"},
"https://webidl.spec.whatwg.org/#idl-DOMString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"DOMString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"https://webidl.spec.whatwg.org/#idl-USVString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"USVString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"https://webidl.spec.whatwg.org/#idl-promise": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Promise","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-promise"},
"https://webidl.spec.whatwg.org/#idl-undefined": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"undefined","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-undefined"},
"https://webidl.spec.whatwg.org/#idl-unsigned-short": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"unsigned short","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-unsigned-short"},
"https://websockets.spec.whatwg.org/#enumdef-binarytype": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"websockets","spec":"websockets","status":"current","text":"BinaryType","type":"enum","url":"https://websockets.spec.whatwg.org/#enumdef-binarytype"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getRootLevelAbsolutePosition(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getRootLevelAbsolutePosition(el) {
    const boundsRect = el.getBoundingClientRect();
    let xPos = 0;
    let yPos = 0;

    while (el) {
        let xScroll = el.scrollLeft;
        let yScroll = el.scrollTop;

        // Ignore scrolling of body.
        if (el.tagName === "BODY") {
            xScroll = 0;
            yScroll = 0;
        }
        xPos += (el.offsetLeft - xScroll + el.clientLeft);
        yPos += (el.offsetTop - yScroll + el.clientTop);

        el = el.offsetParent;
    }
    return {
        left: xPos,
        top: yPos,
        right: xPos + boundsRect.width,
        bottom: yPos + boundsRect.height,
    };
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mouseover", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>